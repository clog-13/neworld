#  å¤åˆç±»å‹

å¦‚æœè¯´ä¹‹å‰å­¦çš„åŸºç¡€æ•°æ®ç±»å‹æ˜¯åŸå­ï¼Œé‚£ä¹ˆæœ¬ç« å°†è®²çš„æ•°æ®ç±»å‹å¯ä»¥è®¤ä¸ºæ˜¯åˆ†å­ã€‚

å¤åˆç±»å‹æ˜¯ç”±å…¶å®ƒç±»å‹ç»„åˆè€Œæˆçš„ï¼Œæœ€å…¸å‹çš„å°±æ˜¯ç»“æ„ä½“ `struct` å’Œæšä¸¾ `enum`ã€‚ä¾‹å¦‚å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ `point(x, y)`ï¼Œå®ƒç”±ä¸¤ä¸ªæ•°å€¼ç±»å‹çš„å€¼ `x` å’Œ `y` ç»„åˆè€Œæ¥ã€‚æˆ‘ä»¬æ— æ³•å•ç‹¬å»ç»´æŠ¤è¿™ä¸¤ä¸ªæ•°å€¼ï¼Œå› ä¸ºå•ç‹¬ä¸€ä¸ª `x` æˆ–è€… `y` æ˜¯å«ä¹‰ä¸å®Œæ•´çš„ï¼Œæ— æ³•æ ‡è¯†å¹³é¢ä¸Šçš„ä¸€ä¸ªç‚¹ï¼Œåº”è¯¥æŠŠå®ƒä»¬çœ‹ä½œä¸€ä¸ªæ•´ä½“å»ç†è§£å’Œå¤„ç†ã€‚

æ¥çœ‹ä¸€æ®µä»£ç ï¼Œå®ƒä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å­¦è¿‡çš„å†…å®¹æ¥æ„å»ºæ–‡ä»¶æ“ä½œï¼š

```rust
#![allow(unused_variables)]
type File = String;

fn open(f: &mut File) -> bool {
    true
}
fn close(f: &mut File) -> bool {
    true
}

#[allow(dead_code)]
fn read(f: &mut File, save_to: &mut Vec<u8>) -> ! {
    unimplemented!()
}

fn main() {
    let mut f1 = File::from("f1.txt");
    open(&mut f1);
    //read(&mut f1, &mut vec![]);
    close(&mut f1);
}
```

æ¥ä¸‹æ¥æˆ‘ä»¬çš„å­¦ä¹ éå¸¸ç±»ä¼¼åŸå‹è®¾è®¡ï¼šæœ‰çš„æ–¹æ³•åªæä¾› API æ¥å£ï¼Œä½†æ˜¯ä¸æä¾›å…·ä½“å®ç°ã€‚æ­¤å¤–ï¼Œæœ‰çš„å˜é‡åœ¨å£°æ˜ä¹‹åå¹¶æœªä½¿ç”¨ï¼Œå› æ­¤åœ¨è¿™ä¸ªé˜¶æ®µæˆ‘ä»¬éœ€è¦æ’é™¤ä¸€äº›ç¼–è¯‘å™¨å™ªéŸ³ï¼ˆRust åœ¨ç¼–è¯‘çš„æ—¶å€™ä¼šæ‰«æä»£ç ï¼Œå˜é‡å£°æ˜åæœªä½¿ç”¨ä¼šä»¥ `warning` è­¦å‘Šçš„å½¢å¼è¿›è¡Œæç¤ºï¼‰ï¼Œ**å¼•å…¥ `#![allow(unused_variables)]` å±æ€§æ ‡è®°ï¼Œè¯¥æ ‡è®°ä¼šå‘Šè¯‰ç¼–è¯‘å™¨å¿½ç•¥æœªä½¿ç”¨çš„å˜é‡**ï¼Œä¸è¦æŠ›å‡º `warning` è­¦å‘Š,å…·ä½“çš„å¸¸è§ç¼–è¯‘å™¨å±æ€§ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥é˜…ï¼š[ç¼–è¯‘å™¨å±æ€§æ ‡è®°](https://course.rs/profiling/compiler/attributes.html)ã€‚

`**#![allow(unused_variables)]` å°†å¯¹æ•´ä¸ªæ–‡ä»¶æœ‰æ•ˆï¼Œ `#[allow(unused_variables)]` åªå¯¹è¯¥è¡Œä¸‹é¢çš„å—æœ‰æ•ˆ**

`read` å‡½æ•°ä¹Ÿéå¸¸æœ‰è¶£ï¼Œå®ƒè¿”å›ä¸€ä¸ª `!` ç±»å‹ï¼Œè¿™ä¸ªè¡¨æ˜è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªå‘æ•£å‡½æ•°ï¼Œ**ä¸ä¼šè¿”å›ä»»ä½•å€¼ï¼ŒåŒ…æ‹¬ `()`**ã€‚`unimplemented!()` å‘Šè¯‰ç¼–è¯‘å™¨è¯¥å‡½æ•°å°šæœªå®ç°ï¼Œ**`unimplemented!()` æ ‡è®°é€šå¸¸æ„å‘³ç€æˆ‘ä»¬æœŸæœ›å¿«é€Ÿå®Œæˆä¸»è¦ä»£ç ï¼Œå›å¤´å†é€šè¿‡æœç´¢è¿™äº›æ ‡è®°æ¥å®Œæˆæ¬¡è¦ä»£ç ï¼Œç±»ä¼¼çš„æ ‡è®°è¿˜æœ‰ `todo!()`**ï¼Œå½“ä»£ç æ‰§è¡Œåˆ°è¿™ç§æœªå®ç°çš„åœ°æ–¹æ—¶ï¼Œç¨‹åºä¼šç›´æ¥æŠ¥é”™ã€‚ä½ å¯ä»¥åæ³¨é‡Š `read(&mut f1, &mut vec![]);` è¿™è¡Œï¼Œç„¶åå†è§‚å¯Ÿä¸‹ç»“æœã€‚

åŒæ—¶ï¼Œä»ä»£ç è®¾è®¡è§’åº¦æ¥çœ‹ï¼Œå…³äºæ–‡ä»¶æ“ä½œçš„ç±»å‹å’Œå‡½æ•°åº”è¯¥ç»„ç»‡åœ¨ä¸€èµ·ï¼Œæ•£è½å¾—åˆ°å¤„éƒ½æ˜¯ï¼Œæ˜¯éš¾ä»¥ç®¡ç†å’Œä½¿ç”¨çš„ã€‚è€Œä¸”é€šè¿‡ `open(&mut f1)` è¿›è¡Œè°ƒç”¨ï¼Œä¹Ÿè¿œæ²¡æœ‰ä½¿ç”¨ `f1.open()` æ¥è°ƒç”¨å¥½ï¼Œè¿™å°±ä½“ç°å‡ºäº†åªä½¿ç”¨åŸºæœ¬ç±»å‹çš„å±€é™æ€§ï¼š**æ— æ³•ä»æ›´é«˜çš„æŠ½è±¡å±‚æ¬¡å»ç®€åŒ–ä»£ç **ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¼•å…¥ä¸€ä¸ªé«˜çº§æ•°æ®ç»“æ„ â€”â€” ç»“æ„ä½“ `struct`ï¼Œæ¥çœ‹çœ‹å¤åˆç±»å‹æ˜¯æ€æ ·æ›´å¥½çš„è§£å†³è¿™ç±»é—®é¢˜ã€‚ å¼€å§‹ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹ Rust çš„é‡ç‚¹ä¹Ÿæ˜¯éš¾ç‚¹ï¼šå­—ç¬¦ä¸² `String` å’Œ `&str`ã€‚

# å­—ç¬¦ä¸²ä¸åˆ‡ç‰‡

## å­—ç¬¦ä¸²

é¦–å…ˆæ¥çœ‹æ®µå¾ˆç®€å•çš„ä»£ç ï¼š

```rust
fn main() {
  let my_name = "Pascal";
  greet(my_name);
}

fn greet(name: String) {
  println!("Hello, {}!", name);
}
```

`greet` å‡½æ•°æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„ `name` å‚æ•°ï¼Œç„¶åæ‰“å°åˆ°ç»ˆç«¯æ§åˆ¶å°ä¸­ï¼Œéå¸¸å¥½ç†è§£ï¼Œä½ ä»¬çŒœçŒœï¼Œè¿™æ®µä»£ç èƒ½å¦é€šè¿‡ç¼–è¯‘ï¼Ÿ

```conole
error[E0308]: mismatched types
 --> src/main.rs:3:11
  |
3 |     greet(my_name);
  |           ^^^^^^^
  |           |
  |           expected struct `std::string::String`, found `&str`
  |           help: try using a conversion method: `my_name.to_string()`

error: aborting due to previous error
```

ç¼–è¯‘å™¨æç¤º `greet` å‡½æ•°éœ€è¦ä¸€ä¸ª `String` ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œå´ä¼ å…¥äº†ä¸€ä¸ª `&str` ç±»å‹çš„å­—ç¬¦ä¸²ã€‚

åœ¨è®²è§£å­—ç¬¦ä¸²ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯åˆ‡ç‰‡?

## åˆ‡ç‰‡(slice)

åˆ‡ç‰‡å¹¶ä¸æ˜¯ Rust ç‹¬æœ‰çš„æ¦‚å¿µï¼Œåœ¨ Go è¯­è¨€ä¸­å°±éå¸¸æµè¡Œï¼Œå®ƒå…è®¸ä½ å¼•ç”¨é›†åˆä¸­éƒ¨åˆ†è¿ç»­çš„å…ƒç´ åºåˆ—ï¼Œè€Œä¸æ˜¯å¼•ç”¨æ•´ä¸ªé›†åˆã€‚

å¯¹äºå­—ç¬¦ä¸²è€Œè¨€ï¼Œåˆ‡ç‰‡å°±æ˜¯å¯¹ `String` ç±»å‹ä¸­æŸä¸€éƒ¨åˆ†çš„å¼•ç”¨ï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

```rust
let s = String::from("hello world");

let hello = &s[0..5];
let world = &s[6..11];
```

`hello` æ²¡æœ‰å¼•ç”¨æ•´ä¸ª `String s`ï¼Œè€Œæ˜¯å¼•ç”¨äº† `s` çš„ä¸€éƒ¨åˆ†å†…å®¹ï¼Œé€šè¿‡ `[0..5]` çš„æ–¹å¼æ¥æŒ‡å®šã€‚

è¿™å°±æ˜¯åˆ›å»ºåˆ‡ç‰‡çš„è¯­æ³•ï¼Œä½¿ç”¨æ–¹æ‹¬å·åŒ…æ‹¬çš„ä¸€ä¸ªåºåˆ—ï¼š**[å¼€å§‹ç´¢å¼•..ç»ˆæ­¢ç´¢å¼•]**ï¼Œå…¶ä¸­å¼€å§‹ç´¢å¼•æ˜¯åˆ‡ç‰‡ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ä½ç½®ï¼Œè€Œç»ˆæ­¢ç´¢å¼•æ˜¯æœ€åä¸€ä¸ªå…ƒç´ åé¢çš„ç´¢å¼•ä½ç½®ï¼Œä¹Ÿå°±æ˜¯è¿™æ˜¯ä¸€ä¸ª `å³åŠå¼€åŒºé—´`ã€‚åœ¨åˆ‡ç‰‡æ•°æ®ç»“æ„å†…éƒ¨ä¼šä¿å­˜å¼€å§‹çš„ä½ç½®å’Œåˆ‡ç‰‡çš„é•¿åº¦ï¼Œå…¶ä¸­é•¿åº¦æ˜¯é€šè¿‡ `ç»ˆæ­¢ç´¢å¼•` - `å¼€å§‹ç´¢å¼•` çš„æ–¹å¼è®¡ç®—å¾—æ¥çš„ã€‚

å¯¹äº `let world = &s[6..11];` æ¥è¯´ï¼Œ`world` æ˜¯ä¸€ä¸ªåˆ‡ç‰‡ï¼Œè¯¥åˆ‡ç‰‡çš„æŒ‡é’ˆæŒ‡å‘ `s` çš„ç¬¬ 7 ä¸ªå­—èŠ‚(ç´¢å¼•ä» 0 å¼€å§‹, 6 æ˜¯ç¬¬ 7 ä¸ªå­—èŠ‚)ï¼Œä¸”è¯¥åˆ‡ç‰‡çš„é•¿åº¦æ˜¯ `5` ä¸ªå­—èŠ‚ã€‚

![img](https://pic1.zhimg.com/80/v2-69da917741b2c610732d8526a9cc86f5_1440w.jpg)

åœ¨ä½¿ç”¨ Rust çš„ `..` [range åºåˆ—](https://course.rs/basic/base-type/numbers.html#åºåˆ—range)è¯­æ³•æ—¶ï¼Œå¦‚æœä½ æƒ³ä»ç´¢å¼• 0 å¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹å¼ï¼Œè¿™ä¸¤ä¸ªæ˜¯ç­‰æ•ˆçš„ï¼š

```rust
let s = String::from("hello");

let slice = &s[0..2];
let slice = &s[..2];
```

åŒæ ·çš„ï¼Œå¦‚æœä½ çš„åˆ‡ç‰‡æƒ³è¦åŒ…å« `String` çš„æœ€åä¸€ä¸ªå­—èŠ‚ï¼Œåˆ™å¯ä»¥è¿™æ ·ä½¿ç”¨:

```rust
let s = String::from("hello");

let len = s.len();

let slice = &s[4..len];
let slice = &s[4..];
```

ä½ ä¹Ÿå¯ä»¥æˆªå–å®Œæ•´çš„ `String` åˆ‡ç‰‡ï¼š

```rust
let s = String::from("hello");

let len = s.len();

let slice = &s[0..len];
let slice = &s[..];
```

**åœ¨å¯¹å­—ç¬¦ä¸²ä½¿ç”¨åˆ‡ç‰‡è¯­æ³•æ—¶éœ€è¦æ ¼å¤–å°å¿ƒï¼Œåˆ‡ç‰‡çš„ç´¢å¼•å¿…é¡»è½åœ¨å­—ç¬¦ä¹‹é—´çš„è¾¹ç•Œä½ç½®ï¼Œä¹Ÿå°±æ˜¯ UTF-8 å­—ç¬¦çš„è¾¹ç•Œï¼Œä¾‹å¦‚ä¸­æ–‡åœ¨ UTF-8 ä¸­å ç”¨ä¸‰ä¸ªå­—èŠ‚,ä¸‹é¢çš„ä»£ç å°±ä¼šå´©æºƒ:**

 ```rust
 let s = "ä¸­å›½äºº";
 let a = &s[0..2];
 println!("{}",a);
 ```

å› ä¸ºæˆ‘ä»¬åªå– `s` å­—ç¬¦ä¸²çš„å‰ä¸¤ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æœ¬ä¾‹ä¸­æ¯ä¸ªæ±‰å­—å ç”¨ä¸‰ä¸ªå­—èŠ‚ï¼Œå› æ­¤æ²¡æœ‰è½åœ¨è¾¹ç•Œå¤„ï¼Œä¹Ÿå°±æ˜¯è¿ `ä¸­` å­—éƒ½å–ä¸å®Œæ•´ï¼Œæ­¤æ—¶ç¨‹åºä¼šç›´æ¥å´©æºƒé€€å‡ºï¼Œå¦‚æœæ”¹æˆ `&s[0..3]`ï¼Œåˆ™å¯ä»¥æ­£å¸¸é€šè¿‡ç¼–è¯‘ã€‚ å› æ­¤ï¼Œå½“ä½ éœ€è¦å¯¹å­—ç¬¦ä¸²åšåˆ‡ç‰‡ç´¢å¼•æ“ä½œæ—¶ï¼Œéœ€è¦æ ¼å¤–å°å¿ƒè¿™ä¸€ç‚¹, å…³äºè¯¥å¦‚ä½•æ“ä½œ UTF-8 å­—ç¬¦ä¸²ï¼Œå‚è§[è¿™é‡Œ](https://course.rs/basic/compound-type/string-slice.html#æ“ä½œ-utf-8-å­—ç¬¦ä¸²)

**å­—ç¬¦ä¸²åˆ‡ç‰‡çš„ç±»å‹æ ‡è¯†æ˜¯ `&str`**ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¿™æ ·å£°æ˜ä¸€ä¸ªå‡½æ•°ï¼Œè¾“å…¥ `String` ç±»å‹ï¼Œè¿”å›å®ƒçš„åˆ‡ç‰‡: `fn first_word(s: &String) -> &str `ã€‚

æœ‰äº†åˆ‡ç‰‡å°±å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š

```rust
fn main() {
    let mut s = String::from("hello world");

    let word = first_word(&s);

    s.clear(); // error!

    println!("the first word is: {}", word);
}
fn first_word(s: &String) -> &str {
    &s[..1]
}
```

ç¼–è¯‘å™¨æŠ¥é”™å¦‚ä¸‹ï¼š

```console
error[E0502]: cannot borrow `s` as mutable because it is also borrowed as immutable
  --> src/main.rs:18:5
   |
16 |     let word = first_word(&s);
   |                           -- immutable borrow occurs here
17 |
18 |     s.clear(); // error!
   |     ^^^^^^^^^ mutable borrow occurs here
19 |
20 |     println!("the first word is: {}", word);
   |                                       ---- immutable borrow later used here
```

å›å¿†ä¸€ä¸‹å€Ÿç”¨çš„è§„åˆ™ï¼šå½“æˆ‘ä»¬å·²ç»æœ‰äº†å¯å˜å€Ÿç”¨æ—¶ï¼Œå°±æ— æ³•å†æ‹¥æœ‰ä¸å¯å˜çš„å€Ÿç”¨ã€‚å› ä¸º `clear` éœ€è¦æ¸…ç©ºæ”¹å˜ `String`ï¼Œå› æ­¤å®ƒéœ€è¦ä¸€ä¸ªå¯å˜å€Ÿç”¨ï¼ˆåˆ©ç”¨ VSCode å¯ä»¥çœ‹åˆ°è¯¥æ–¹æ³•çš„å£°æ˜æ˜¯ `pub fn clear(&mut self)` ï¼Œå‚æ•°æ˜¯å¯¹è‡ªèº«çš„å¯å˜å€Ÿç”¨ ï¼‰ï¼›è€Œä¹‹åçš„ `println!` åˆä½¿ç”¨äº†ä¸å¯å˜å€Ÿç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨ `s.clear()` å¤„å¯å˜å€Ÿç”¨ä¸ä¸å¯å˜å€Ÿç”¨è¯•å›¾åŒæ—¶ç”Ÿæ•ˆï¼Œå› æ­¤ç¼–è¯‘æ— æ³•é€šè¿‡ã€‚

ä»ä¸Šè¿°ä»£ç å¯ä»¥çœ‹å‡ºï¼ŒRust ä¸ä»…è®©æˆ‘ä»¬çš„ `API` æ›´åŠ å®¹æ˜“ä½¿ç”¨ï¼Œè€Œä¸”ä¹Ÿåœ¨ç¼–è¯‘æœŸå°±æ¶ˆé™¤äº†å¤§é‡é”™è¯¯ï¼

**å…¶å®ƒåˆ‡ç‰‡**

å› ä¸ºåˆ‡ç‰‡æ˜¯å¯¹é›†åˆçš„éƒ¨åˆ†å¼•ç”¨ï¼Œå› æ­¤ä¸ä»…ä»…å­—ç¬¦ä¸²æœ‰åˆ‡ç‰‡ï¼Œå…¶å®ƒé›†åˆç±»å‹ä¹Ÿæœ‰ï¼Œä¾‹å¦‚æ•°ç»„ï¼š

```rust
let a = [1, 2, 3, 4, 5];
let slice = &a[1..3];
assert_eq!(slice, &[2, 3]);
```

## å­—ç¬¦ä¸²å­—é¢é‡æ˜¯åˆ‡ç‰‡

ä¹‹å‰æåˆ°è¿‡å­—ç¬¦ä¸²å­—é¢é‡,ä½†æ˜¯æ²¡æœ‰æåˆ°å®ƒçš„ç±»å‹ï¼š

```rust
let s = "Hello, world!";
```

**å®é™…ä¸Šï¼Œ`s` çš„ç±»å‹æ˜¯ `&str`**ï¼ˆè¿™ä¸æ˜¯ C è¯­è¨€ï¼Œ&str ä»£è¡¨å­—ç¬¦ä¸²åˆ‡ç‰‡çš„å¼•ç”¨ï¼‰ï¼Œå› æ­¤ä½ ä¹Ÿå¯ä»¥è¿™æ ·å£°æ˜ï¼š

```rust
let s: &str = "Hello, world!";
```

è¯¥åˆ‡ç‰‡æŒ‡å‘äº†ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æŸä¸ªç‚¹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸å¯å˜çš„ï¼Œå› ä¸º **`&str` æ˜¯ä¸€ä¸ªä¸å¯å˜å¼•ç”¨**ã€‚

äº†è§£å®Œåˆ‡ç‰‡ï¼Œå¯ä»¥è¿›å…¥æœ¬èŠ‚çš„æ­£é¢˜äº†ã€‚

## ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²?

å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦ç»„æˆçš„è¿ç»­é›†åˆï¼Œ**Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)**ï¼Œè¿™æ ·æœ‰åŠ©äºå¤§å¹…é™ä½å­—ç¬¦ä¸²æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚

**Rust åœ¨è¯­è¨€çº§åˆ«ï¼Œåªæœ‰ä¸€ç§å­—ç¬¦ä¸²ç±»å‹ï¼š `str`ï¼Œå®ƒé€šå¸¸æ˜¯ä»¥å¼•ç”¨ç±»å‹å‡ºç° `&str`**ï¼Œä¹Ÿå°±æ˜¯ä¸Šæ–‡æåˆ°çš„å­—ç¬¦ä¸²åˆ‡ç‰‡ã€‚è™½ç„¶è¯­è¨€çº§åˆ«åªæœ‰ä¸Šè¿°çš„ `str` ç±»å‹ï¼Œä½†æ˜¯åœ¨æ ‡å‡†åº“é‡Œï¼Œè¿˜æœ‰å¤šç§ä¸åŒç”¨é€”çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œå…¶ä¸­ä½¿ç”¨æœ€å¹¿çš„å³æ˜¯ `String` ç±»å‹ã€‚

`str` ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ **`String` åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²**ï¼Œå½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ `String` ç±»å‹å’Œ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œ**è¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç **ã€‚

é™¤äº† `String` ç±»å‹çš„å­—ç¬¦ä¸²ï¼ŒRust çš„æ ‡å‡†åº“è¿˜æä¾›äº†å…¶ä»–ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `OsString`ï¼Œ `OsStr`ï¼Œ `CsString` å’Œ` CsStr` ç­‰ï¼Œæ³¨æ„åˆ°è¿™äº›åå­—éƒ½ä»¥ `String` æˆ–è€… `Str` ç»“å°¾äº†å—ï¼Ÿå®ƒä»¬åˆ†åˆ«å¯¹åº”çš„æ˜¯**å…·æœ‰æ‰€æœ‰æƒå’Œè¢«å€Ÿç”¨çš„å˜é‡**ã€‚

## String ä¸ &str çš„è½¬æ¢

åœ¨ä¹‹å‰çš„ä»£ç ä¸­ï¼Œå·²ç»è§åˆ°å¥½å‡ ç§**ä» `&str` ç±»å‹ç”Ÿæˆ `String` ç±»å‹çš„æ“ä½œ**ï¼š

- `String::from("hello,world")`
- `"hello,world".to_string()`

å°† `String` ç±»å‹è½¬ä¸º `&str` ç±»å‹**å–å¼•ç”¨å³å¯**ï¼š

```rust
fn main() {
    let s = String::from("hello,world!");
    say_hello(&s);
    say_hello(&s[..]);
    say_hello(s.as_str());
}

fn say_hello(s: &str) {
    println!("{}",s);
}
```

å®é™…ä¸Šè¿™ç§çµæ´»ç”¨æ³•æ˜¯å› ä¸º `deref` éšå¼å¼ºåˆ¶è½¬æ¢ï¼Œå…·ä½“æˆ‘ä»¬ä¼šåœ¨ [`Deref` ç‰¹å¾](https://course.rs/advance/smart-pointer/deref.html)è¿›è¡Œè¯¦ç»†è®²è§£ã€‚

## å­—ç¬¦ä¸²ç´¢å¼•

ä½¿ç”¨ç´¢å¼•çš„æ–¹å¼è®¿é—®å­—ç¬¦ä¸²çš„æŸä¸ªå­—ç¬¦æˆ–è€…å­ä¸²åœ¨ Rust ä¸­å°±ä¼šæŠ¥é”™:

```rust
   let s1 = String::from("hello");
   let h = s1[0];
```

è¯¥ä»£ç ä¼šäº§ç”Ÿå¦‚ä¸‹é”™è¯¯ï¼š

```console
3 |     let h = s1[0];
  |             ^^^^^ `String` cannot be indexed by `{integer}`
  |
  = help: the trait `Index<{integer}>` is not implemented for `String`
```

### æ·±å…¥å­—ç¬¦ä¸²å†…éƒ¨

å­—ç¬¦ä¸²çš„åº•å±‚çš„æ•°æ®å­˜å‚¨æ ¼å¼å®é™…ä¸Šæ˜¯[ `u8` ]ï¼Œä¸€ä¸ªå­—èŠ‚æ•°ç»„ã€‚å¯¹äº `let hello = String::from("Hola");` è¿™è¡Œä»£ç æ¥è¯´ï¼Œ`Hola` çš„é•¿åº¦æ˜¯ `4` ä¸ªå­—èŠ‚ï¼Œå› ä¸º `"Hola"` ä¸­çš„æ¯ä¸ªå­—æ¯åœ¨ UTF-8 ç¼–ç ä¸­ä»…å ç”¨ 1 ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¯¹äºä¸‹é¢çš„ä»£ç å‘¢ï¼Ÿ

```rust
let hello = String::from("ä¸­å›½äºº");
```

å¦‚æœé—®ä½ è¯¥å­—ç¬¦ä¸²å¤šé•¿ï¼Œä½ å¯èƒ½ä¼šè¯´ `3`ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯ `9` ä¸ªå­—èŠ‚çš„é•¿åº¦ï¼Œå› ä¸ºå¤§éƒ¨åˆ†å¸¸ç”¨æ±‰å­—åœ¨ UTF-8 ä¸­çš„é•¿åº¦æ˜¯ `3` ä¸ªå­—èŠ‚ï¼Œå› æ­¤è¿™ç§æƒ…å†µä¸‹å¯¹ `hello` è¿›è¡Œç´¢å¼•ï¼Œè®¿é—® `&hello[0]` æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºä½ å–ä¸åˆ° `ä¸­` è¿™ä¸ªå­—ç¬¦ï¼Œè€Œæ˜¯å–åˆ°äº†è¿™ä¸ªå­—ç¬¦ä¸‰ä¸ªå­—èŠ‚ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ã€‚

### å­—ç¬¦ä¸²çš„ä¸åŒè¡¨ç°å½¢å¼

ç°åœ¨çœ‹ä¸€ä¸‹ç”¨æ¢µæ–‡å†™çš„å­—ç¬¦ä¸² `â€œà¤¨à¤®à¤¸à¥à¤¤à¥‡â€`, å®ƒåº•å±‚çš„å­—èŠ‚æ•°ç»„å¦‚ä¸‹å½¢å¼ï¼š

```rust
[224, 164, 168, 224, 164, 174, 224, 164, 184, 224, 165, 141, 224, 164, 164, 224, 165, 135]
```

é•¿åº¦æ˜¯ 18 ä¸ªå­—èŠ‚ï¼Œè¿™ä¹Ÿæ˜¯è®¡ç®—æœºæœ€ç»ˆå­˜å‚¨è¯¥å­—ç¬¦ä¸²çš„å½¢å¼ã€‚å¦‚æœä»å­—ç¬¦çš„å½¢å¼å»çœ‹ï¼Œåˆ™æ˜¯ï¼š

```rust
['à¤¨', 'à¤®', 'à¤¸', 'à¥', 'à¤¤', 'à¥‡']
```

ä½†æ˜¯è¿™ç§å½¢å¼ä¸‹ï¼Œç¬¬å››å’Œå…­ä¸¤ä¸ªå­—æ¯æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œæ¥ç€å†ä»å­—æ¯ä¸²çš„å½¢å¼å»çœ‹ï¼š

```rust
["à¤¨", "à¤®", "à¤¸à¥", "à¤¤à¥‡"]
```

æ‰€ä»¥ï¼Œå¯ä»¥çœ‹å‡ºæ¥ Rust æä¾›äº†ä¸åŒçš„å­—ç¬¦ä¸²å±•ç°æ–¹å¼ï¼Œ**è¿™æ ·ç¨‹åºå¯ä»¥æŒ‘é€‰è‡ªå·±æƒ³è¦çš„æ–¹å¼å»ä½¿ç”¨ï¼Œè€Œæ— éœ€å»ç®¡å­—ç¬¦ä¸²ä»äººç±»è¯­è¨€è§’åº¦çœ‹é•¿ä»€ä¹ˆæ ·**ã€‚

è¿˜æœ‰ä¸€ä¸ªåŸå› å¯¼è‡´äº† Rust ä¸å…è®¸å»ç´¢å¼•å­—ç¬¦ä¸²ï¼šå› ä¸ºç´¢å¼•æ“ä½œï¼Œæˆ‘ä»¬æ€»æ˜¯æœŸæœ›å®ƒçš„æ€§èƒ½è¡¨ç°æ˜¯ O(1)ï¼Œç„¶è€Œå¯¹äº `String` ç±»å‹æ¥è¯´ï¼Œæ— æ³•ä¿è¯è¿™ä¸€ç‚¹ï¼Œå› ä¸º Rust å¯èƒ½éœ€è¦ä» 0 å¼€å§‹å»éå†å­—ç¬¦ä¸²æ¥å®šä½åˆæ³•çš„å­—ç¬¦ã€‚

## å­—ç¬¦ä¸²åˆ‡ç‰‡

å‰æ–‡æåˆ°è¿‡ï¼Œå­—ç¬¦ä¸²åˆ‡ç‰‡æ˜¯éå¸¸å±é™©çš„æ“ä½œï¼Œå› ä¸ºåˆ‡ç‰‡çš„ç´¢å¼•æ˜¯é€šè¿‡å­—èŠ‚æ¥è¿›è¡Œï¼Œä½†æ˜¯å­—ç¬¦ä¸²åˆæ˜¯ UTF-8 ç¼–ç ï¼Œå› æ­¤ä½ æ— æ³•ä¿è¯ç´¢å¼•çš„å­—èŠ‚åˆšå¥½è½åœ¨å­—ç¬¦çš„è¾¹ç•Œä¸Šï¼Œä¾‹å¦‚ï¼š

```rust
let hello = "ä¸­å›½äºº";
let s = &hello[0..2];
```

è¿è¡Œä¸Šé¢çš„ç¨‹åºï¼Œä¼šç›´æ¥é€ æˆå´©æºƒï¼š

```console
thread 'main' panicked at 'byte index 2 is not a char boundary; it is inside 'ä¸­' (bytes 0..3) of `ä¸­å›½äºº`', src/main.rs:4:14
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

è¿™é‡Œæç¤ºçš„å¾ˆæ¸…æ¥šï¼Œæˆ‘ä»¬ç´¢å¼•çš„å­—èŠ‚è½åœ¨äº† `ä¸­` å­—ç¬¦çš„å†…éƒ¨ï¼Œè¿™ç§è¿”å›æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚

å› æ­¤åœ¨é€šè¿‡ç´¢å¼•åŒºé—´æ¥è®¿é—®å­—ç¬¦ä¸²æ—¶ï¼Œ**éœ€è¦æ ¼å¤–çš„å°å¿ƒ**ï¼Œä¸€ä¸æ³¨æ„ï¼Œå°±ä¼šå¯¼è‡´ä½ ç¨‹åºçš„å´©æºƒï¼

## æ“ä½œå­—ç¬¦ä¸²

 `String` æ˜¯å¯å˜å­—ç¬¦ä¸²ï¼Œä¸‹é¢ä»‹ç» Rust å­—ç¬¦ä¸²çš„ä¿®æ”¹ï¼Œæ·»åŠ ï¼Œåˆ é™¤ç­‰å¸¸ç”¨æ–¹æ³•ï¼š

### è¿½åŠ  (Push)

åœ¨å­—ç¬¦ä¸²å°¾éƒ¨å¯ä»¥ä½¿ç”¨ `push()` æ–¹æ³•è¿½åŠ å­—ç¬¦ `char`ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `push_str()` æ–¹æ³•è¿½åŠ å­—ç¬¦ä¸²å­—é¢é‡ã€‚è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯**åœ¨åŸæœ‰çš„å­—ç¬¦ä¸²ä¸Šè¿½åŠ ï¼Œå¹¶ä¸ä¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²**ã€‚ç”±äºå­—ç¬¦ä¸²è¿½åŠ æ“ä½œè¦ä¿®æ”¹åŸæ¥çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯å¯å˜çš„ï¼Œå³**å­—ç¬¦ä¸²å˜é‡å¿…é¡»ç”± `mut` å…³é”®å­—ä¿®é¥°**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("Hello ");
    s.push('r');
    println!("è¿½åŠ å­—ç¬¦ push() -> {}", s);

    s.push_str("ust!");
    println!("è¿½åŠ å­—ç¬¦ä¸² push_str() -> {}", s);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
è¿½åŠ å­—ç¬¦ push() -> Hello r
è¿½åŠ å­—ç¬¦ä¸² push_str() -> Hello rust!
```

### æ’å…¥ (Insert)

å¯ä»¥ä½¿ç”¨ `insert()` æ–¹æ³•æ’å…¥å•ä¸ªå­—ç¬¦ `char`ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ `insert_str()` æ–¹æ³•æ’å…¥å­—ç¬¦ä¸²å­—é¢é‡ï¼Œè¿™ä¿©æ–¹æ³•éœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ï¼ˆä¸²ï¼‰æ’å…¥ä½ç½®çš„ç´¢å¼•ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¦æ’å…¥çš„å­—ç¬¦ï¼ˆä¸²ï¼‰ï¼Œç´¢å¼•ä» 0 å¼€å§‹è®¡æ•°ï¼Œå¦‚æœè¶Šç•Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚ç”±äºå­—ç¬¦ä¸²æ’å…¥æ“ä½œè¦**ä¿®æ”¹åŸæ¥çš„å­—ç¬¦ä¸²**ï¼Œåˆ™è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯å¯å˜çš„ï¼Œå³**å­—ç¬¦ä¸²å˜é‡å¿…é¡»ç”± `mut` å…³é”®å­—ä¿®é¥°**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut s = String::from("Hello rust!");
    s.insert(5, ',');
    println!("æ’å…¥å­—ç¬¦ insert() -> {}", s);
    s.insert_str(6, " I like");
    println!("æ’å…¥å­—ç¬¦ä¸² insert_str() -> {}", s);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
æ’å…¥å­—ç¬¦ insert() -> Hello, rust!
æ’å…¥å­—ç¬¦ä¸² insert_str() -> Hello, I like rust!
```

### æ›¿æ¢ (Replace)

å¦‚æœæƒ³è¦æŠŠå­—ç¬¦ä¸²ä¸­çš„æŸä¸ªå­—ç¬¦ä¸²æ›¿æ¢æˆå…¶å®ƒçš„å­—ç¬¦ä¸²ï¼Œé‚£å¯ä»¥ä½¿ç”¨ `replace()` æ–¹æ³•ã€‚ä¸æ›¿æ¢æœ‰å…³çš„æ–¹æ³•æœ‰ä¸‰ä¸ªã€‚

1ã€`replace`

**è¯¥æ–¹æ³•å¯é€‚ç”¨äº `String` å’Œ `&str` ç±»å‹**ã€‚`replace()` æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°çš„å­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•ä¼šæ›¿æ¢æ‰€æœ‰åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²ã€‚**è¯¥æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let string_replace = String::from("I like rust. Learning rust is my favorite!");
    let new_string_replace = string_replace.replace("rust", "RUST");
    dbg!(new_string_replace);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
new_string_replace = "I like RUST. Learning RUST is my favorite!"
```

2ã€`replacen`

**è¯¥æ–¹æ³•å¯é€‚ç”¨äº `String` å’Œ `&str` ç±»å‹**ã€‚`replacen()` æ–¹æ³•æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå‰ä¸¤ä¸ªå‚æ•°ä¸ `replace()` æ–¹æ³•ä¸€æ ·ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ™è¡¨ç¤ºæ›¿æ¢çš„ä¸ªæ•°ã€‚**è¯¥æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let string_replace = "I like rust. Learning rust is my favorite!";
    let new_string_replacen = string_replace.replacen("rust", "RUST", 1);
    dbg!(new_string_replacen);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
new_string_replacen = "I like RUST. Learning rust is my favorite!"
```

3ã€`replace_range`

è¯¥æ–¹æ³•ä»…é€‚ç”¨äº `String` ç±»å‹ã€‚`replace_range` æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ›¿æ¢å­—ç¬¦ä¸²çš„èŒƒå›´ï¼ˆRangeï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°çš„å­—ç¬¦ä¸²ã€‚**è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œä¸ä¼šè¿”å›æ–°çš„å­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•éœ€è¦ä½¿ç”¨ `mut` å…³é”®å­—ä¿®é¥°**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut string_replace_range = String::from("I like rust!");
    string_replace_range.replace_range(7..8, "R");
    dbg!(string_replace_range);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
string_replace_range = "I like Rust!"
```

### åˆ é™¤ (Delete)

ä¸å­—ç¬¦ä¸²åˆ é™¤ç›¸å…³çš„æ–¹æ³•æœ‰ 4 ä¸ªï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ `pop()`ï¼Œ`remove()`ï¼Œ`truncate()`ï¼Œ`clear()`ã€‚è¿™å››ä¸ªæ–¹æ³•ä»…é€‚ç”¨äº `String` ç±»å‹ã€‚

1ã€ `pop` â€”â€” åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªå­—ç¬¦

**è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚ä½†æ˜¯å­˜åœ¨è¿”å›å€¼ï¼Œå…¶è¿”å›å€¼æ˜¯ä¸€ä¸ª `Option` ç±»å‹ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸ºç©ºï¼Œåˆ™è¿”å› `None`ã€‚ ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut string_pop = String::from("rust pop ä¸­æ–‡!");
    let p1 = string_pop.pop();
    let p2 = string_pop.pop();
    dbg!(p1);
    dbg!(p2);
    dbg!(string_pop);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
p1 = Some(
   '!',
)
p2 = Some(
   'æ–‡',
)
string_pop = "rust pop ä¸­"
```

2ã€ `remove` â€”â€” åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦

**è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚ä½†æ˜¯å­˜åœ¨è¿”å›å€¼ï¼Œå…¶è¿”å›å€¼æ˜¯åˆ é™¤ä½ç½®çš„å­—ç¬¦ä¸²ï¼Œåªæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºè¯¥å­—ç¬¦èµ·å§‹ç´¢å¼•ä½ç½®ã€‚`remove()` æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut string_remove = String::from("æµ‹è¯•removeæ–¹æ³•");
    println!(
        "string_remove å  {} ä¸ªå­—èŠ‚",
        std::mem::size_of_val(string_remove.as_str())
    );
    // åˆ é™¤ç¬¬ä¸€ä¸ªæ±‰å­—
    string_remove.remove(0);
    // ä¸‹é¢ä»£ç ä¼šå‘ç”Ÿé”™è¯¯
    // string_remove.remove(1);
    // ç›´æ¥åˆ é™¤ç¬¬äºŒä¸ªæ±‰å­—
    // string_remove.remove(3);
    dbg!(string_remove);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
string_remove å  18 ä¸ªå­—èŠ‚
string_remove = "è¯•removeæ–¹æ³•"
```

3ã€`truncate` â€”â€” åˆ é™¤å­—ç¬¦ä¸²ä¸­ä»æŒ‡å®šä½ç½®å¼€å§‹åˆ°ç»“å°¾çš„å…¨éƒ¨å­—ç¬¦

**è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚æ— è¿”å›å€¼ã€‚è¯¥æ–¹æ³• `truncate()` æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut string_truncate = String::from("æµ‹è¯•truncate");
    string_truncate.truncate(3);
    dbg!(string_truncate);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
string_truncate = "æµ‹"
```

4ã€`clear` â€”â€” æ¸…ç©ºå­—ç¬¦ä¸²

**è¯¥æ–¹æ³•æ˜¯ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²**ã€‚è°ƒç”¨åï¼Œåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œç›¸å½“äº `truncate()` æ–¹æ³•å‚æ•°ä¸º 0 çš„æ—¶å€™ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let mut string_clear = String::from("string clear");
    string_clear.clear();
    dbg!(string_clear);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
string_clear = ""
```

### è¿æ¥ (Catenate)

1ã€ä½¿ç”¨ `+` æˆ–è€… `+=` è¿æ¥å­—ç¬¦ä¸²

**ä½¿ç”¨ `+` æˆ–è€… `+=` è¿æ¥å­—ç¬¦ä¸²ï¼Œè¦æ±‚å³è¾¹çš„å‚æ•°å¿…é¡»ä¸ºå­—ç¬¦ä¸²çš„åˆ‡ç‰‡å¼•ç”¨ï¼ˆSlice)ç±»å‹**ã€‚å…¶å®å½“è°ƒç”¨ `+` çš„æ“ä½œç¬¦æ—¶ï¼Œç›¸å½“äºè°ƒç”¨äº† `std::string` æ ‡å‡†åº“ä¸­çš„ [`add()`](https://doc.rust-lang.org/std/string/struct.String.html#method.add) æ–¹æ³•ï¼Œè¿™é‡Œ `add()` æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¼•ç”¨çš„ç±»å‹ã€‚å› æ­¤æˆ‘ä»¬åœ¨ä½¿ç”¨ `+`ï¼Œ å¿…é¡»ä¼ é€’åˆ‡ç‰‡å¼•ç”¨ç±»å‹ã€‚ä¸èƒ½ç›´æ¥ä¼ é€’ `String` ç±»å‹ã€‚**`+` å’Œ `+=` éƒ½æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚æ‰€ä»¥å˜é‡å£°æ˜å¯ä»¥ä¸éœ€è¦ `mut` å…³é”®å­—ä¿®é¥°**ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let string_append = String::from("hello ");
    let string_rust = String::from("rust");
    // &string_rustä¼šè‡ªåŠ¨è§£å¼•ç”¨ä¸º&str
    let result = string_append + &string_rust;
    let mut result = result + "!";
    result += "!!!";

    println!("è¿æ¥å­—ç¬¦ä¸² + -> {}", result);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
è¿æ¥å­—ç¬¦ä¸² + -> hello rust!!!!
```

`add()` æ–¹æ³•çš„å®šä¹‰ï¼š

```rust
fn add(self, s: &str) -> String
```

å› ä¸ºè¯¥æ–¹æ³•æ¶‰åŠåˆ°æ›´å¤æ‚çš„ç‰¹å¾åŠŸèƒ½ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œç®€å•è¯´æ˜ä¸‹ï¼š

```rust
fn main() {
    let s1 = String::from("hello,");
    let s2 = String::from("world!");
    // åœ¨ä¸‹å¥ä¸­ï¼Œs1çš„æ‰€æœ‰æƒè¢«è½¬ç§»èµ°äº†ï¼Œå› æ­¤åé¢ä¸èƒ½å†ä½¿ç”¨s1
    let s3 = s1 + &s2;
    assert_eq!(s3,"hello,world!");
    // ä¸‹é¢çš„è¯­å¥å¦‚æœå»æ‰æ³¨é‡Šï¼Œå°±ä¼šæŠ¥é”™
    // println!("{}",s1);
}
```

è¯¥å‡½æ•°è¯´æ˜ï¼Œ**åªèƒ½å°† `&str` ç±»å‹çš„å­—ç¬¦ä¸²åˆ‡ç‰‡æ·»åŠ åˆ° `String` ç±»å‹çš„ `s1` ä¸Š**ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„ `String` ç±»å‹ï¼Œæ‰€ä»¥ `let s3 = s1 + &s2;` å°±å¾ˆå¥½è§£é‡Šäº†ï¼Œå°† `String` ç±»å‹çš„ `s1` ä¸ `&str` ç±»å‹çš„ `s2` è¿›è¡Œç›¸åŠ ï¼Œæœ€ç»ˆå¾—åˆ° `String` ç±»å‹çš„ `s3`ã€‚

ç”±æ­¤å¯æ¨ï¼Œä»¥ä¸‹ä»£ç ä¹Ÿæ˜¯åˆæ³•çš„ï¼š

```rust
let s1 = String::from("tic");
let s2 = String::from("tac");
let s3 = String::from("toe");

// String = String + &str + &str + &str + &str
let s = s1 + "-" + &s2 + "-" + &s3;
```

`String + &str`è¿”å›ä¸€ä¸ª `String`ï¼Œç„¶åå†ç»§ç»­è·Ÿä¸€ä¸ª `&str` è¿›è¡Œ `+` æ“ä½œï¼Œè¿”å›ä¸€ä¸ª `String` ç±»å‹ï¼Œä¸æ–­å¾ªç¯ï¼Œ**æœ€ç»ˆç”Ÿæˆä¸€ä¸ª `s`ï¼Œä¹Ÿæ˜¯ `String` ç±»å‹**ã€‚

`s1` è¿™ä¸ªå˜é‡é€šè¿‡è°ƒç”¨ `add()` æ–¹æ³•åï¼Œ**æ‰€æœ‰æƒè¢«è½¬ç§»åˆ° `add()` æ–¹æ³•é‡Œé¢**ï¼Œ `add()` æ–¹æ³•è°ƒç”¨åå°±è¢«é‡Šæ”¾äº†ï¼ŒåŒæ—¶ `s1` ä¹Ÿè¢«é‡Šæ”¾äº†ã€‚å†ä½¿ç”¨ `s1` å°±ä¼šå‘ç”Ÿé”™è¯¯ã€‚è¿™é‡Œæ¶‰åŠåˆ°[æ‰€æœ‰æƒè½¬ç§»ï¼ˆMoveï¼‰](https://course.rs/basic/ownership/ownership.html#è½¬ç§»æ‰€æœ‰æƒ)çš„ç›¸å…³çŸ¥è¯†ã€‚

2ã€ä½¿ç”¨ `format!` è¿æ¥å­—ç¬¦ä¸²

**`format!` è¿™ç§æ–¹å¼é€‚ç”¨äº `String` å’Œ `&str`** ã€‚`format!` çš„ç”¨æ³•ä¸ `print!` çš„ç”¨æ³•ç±»ä¼¼ï¼Œè¯¦è§[æ ¼å¼åŒ–è¾“å‡º](https://course.rs/basic/formatted-output.html#printprintlnformat)ã€‚

ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```rust
fn main() {
    let s1 = "hello";
    let s2 = String::from("rust");
    let s = format!("{} {}!", s1, s2);
    println!("{}", s);
}
```

ä»£ç è¿è¡Œç»“æœï¼š

```console
hello rust!
```

## å­—ç¬¦ä¸²è½¬ä¹‰

æˆ‘ä»¬å¯ä»¥é€šè¿‡è½¬ä¹‰çš„æ–¹å¼ `\` è¾“å‡º ASCII å’Œ Unicode å­—ç¬¦ã€‚

```rust
fn main() {
    // é€šè¿‡ \ + å­—ç¬¦çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œè½¬ä¹‰è¾“å‡ºä¸€ä¸ªå­—ç¬¦
    let byte_escape = "I'm writing \x52\x75\x73\x74!";
    println!("What are you doing\x3F (\\x3F means ?) {}", byte_escape);

    // \u å¯ä»¥è¾“å‡ºä¸€ä¸ª unicode å­—ç¬¦
    let unicode_codepoint = "\u{211D}";
    let character_name = "\"DOUBLE-STRUCK CAPITAL R\"";

    println!(
        "Unicode character {} (U+211D) is called {}",
        unicode_codepoint, character_name
    );

    // æ¢è¡Œäº†ä¹Ÿä¼šä¿æŒä¹‹å‰çš„å­—ç¬¦ä¸²æ ¼å¼
    let long_string = "String literals
                        can span multiple lines.
                        The linebreak and indentation here ->\
                        <- can be escaped too!";
    println!("{}", long_string);
}
```

**å½“ç„¶ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯èƒ½ä½ ä¼šå¸Œæœ›ä¿æŒå­—ç¬¦ä¸²çš„åŸæ ·ï¼Œä¸è¦è½¬ä¹‰:**

```rust
fn main() {
    println!("{}", "hello \\x52\\x75\\x73\\x74");
    let raw_str = r"Escapes don't work here: \x3F \u{211D}";
    println!("{}", raw_str);

    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #
    let quotes = r#"And then I said: "There is no escape!""#;
    println!("{}", quotes);

    // å¦‚æœè¿˜æ˜¯æœ‰æ­§ä¹‰ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ï¼Œæ²¡æœ‰é™åˆ¶
    let longer_delimiter = r###"A string with "# in it. And even "##!"###;
    println!("{}", longer_delimiter);
}
```

### å­—èŠ‚å­—ç¬¦ä¸²

æƒ³è¦ä¸€ä¸ªé UTF-8 å½¢å¼çš„å­—ç¬¦ä¸²å—(æˆ‘ä»¬ä¹‹å‰çš„ `str`, `&str`, `String` éƒ½æ˜¯ UTF-8 å­—ç¬¦ä¸²) ? å¯ä»¥è¯•è¯•å­—èŠ‚å­—ç¬¦ä¸²æˆ–è€…è¯´å­—èŠ‚æ•°ç»„:

**ç¤ºä¾‹**:

```rust
use std::str;

fn main() {
    // æ³¨æ„ï¼Œè¿™å¹¶ä¸æ˜¯ `&str` ç±»å‹äº†ï¼
    let bytestring: &[u8; 21] = b"this is a byte string";


    // å­—èŠ‚æ•°ç»„æ²¡æœ‰å®ç° `Display` ç‰¹å¾ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ `Debug` çš„æ–¹å¼å»æ‰“å°
    println!("A byte string: {:?}", bytestring);

    // å­—èŠ‚æ•°ç»„ä¹Ÿå¯ä»¥ä½¿ç”¨è½¬ä¹‰
    let escaped = b"\x52\x75\x73\x74 as bytes";
    // ...ä½†æ˜¯ä¸æ”¯æŒ unicode è½¬ä¹‰
    // let escaped = b"\u{211D} is not allowed";
    println!("Some escaped bytes: {:?}", escaped);


    // raw string
    let raw_bytestring = br"\u{211D} is not escaped here";
    println!("{:?}", raw_bytestring);

    // å°†å­—èŠ‚æ•°ç»„è½¬æˆ `str` ç±»å‹å¯èƒ½ä¼šå¤±è´¥
    if let Ok(my_str) = str::from_utf8(raw_bytestring) {
        println!("And the same as text: '{}'", my_str);
    }

    let _quotes = br#"You can also use "fancier" formatting, \
                    like with normal raw strings"#;

    // å­—èŠ‚æ•°ç»„å¯ä»¥ä¸æ˜¯ UTF-8 æ ¼å¼
    let shift_jis = b"\x82\xe6\x82\xa8\x82\xb1\x82\xbb"; // "ã‚ˆã†ã“ã" in SHIFT-JIS

    // ä½†æ˜¯å®ƒä»¬æœªå¿…èƒ½è½¬æ¢æˆ `str` ç±»å‹
    match str::from_utf8(shift_jis) {
        Ok(my_str) => println!("Conversion successful: '{}'", my_str),
        Err(e) => println!("Conversion failed: {:?}", e),
    };
}
```

å¦‚æœå¤§å®¶æƒ³è¦äº†è§£æ›´å¤šå…³äºå­—ç¬¦ä¸²å­—é¢é‡ã€è½¬ä¹‰å­—ç¬¦çš„è¯ï¼Œå¯ä»¥çœ‹çœ‹ Rust Reference çš„ ['Tokens' ç« èŠ‚](https://doc.rust-lang.org/reference/tokens.html).

## æ“ä½œ UTF-8 å­—ç¬¦ä¸²

### å­—ç¬¦

å¦‚æœä½ æƒ³è¦ä»¥ Unicode å­—ç¬¦çš„æ–¹å¼éå†å­—ç¬¦ä¸²ï¼Œæœ€å¥½çš„åŠæ³•æ˜¯ä½¿ç”¨ `chars` æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š

```rust
for c in "ä¸­å›½äºº".chars() {
    println!("{}", c);
}
```

è¾“å‡ºå¦‚ä¸‹

```console
ä¸­
å›½
äºº
```

### å­—èŠ‚

è¿™ç§æ–¹å¼æ˜¯è¿”å›å­—ç¬¦ä¸²çš„åº•å±‚å­—èŠ‚æ•°ç»„è¡¨ç°å½¢å¼ï¼š

```rust
for b in "ä¸­å›½äºº".bytes() {
    println!("{}", b);
}
```

è¾“å‡ºå¦‚ä¸‹ï¼š

```console
228
184
173
229
155
189
228
186
186
```

### è·å–å­ä¸²

æƒ³è¦å‡†ç¡®çš„ä» UTF-8 å­—ç¬¦ä¸²ä¸­è·å–å­ä¸²æ˜¯è¾ƒä¸ºå¤æ‚çš„äº‹æƒ…ï¼Œä¾‹å¦‚æƒ³è¦ä» `hollaä¸­å›½äººà¤¨à¤®à¤¸à¥à¤¤à¥‡` è¿™ç§å˜é•¿çš„å­—ç¬¦ä¸²ä¸­å–å‡ºæŸä¸€ä¸ªå­ä¸²ï¼Œä½¿ç”¨æ ‡å‡†åº“ä½ æ˜¯åšä¸åˆ°çš„ã€‚ ä½ éœ€è¦åœ¨ `crates.io` ä¸Šæœç´¢ `utf8` æ¥å¯»æ‰¾æƒ³è¦çš„åŠŸèƒ½ã€‚

#### utf8_slice

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‰æ–¹åº“ [utf8_slice](https://docs.rs/utf8_slice/1.0.0/utf8_slice/fn.slice.html) æ¥è®¿é—® UTF-8 å­—ç¬¦ä¸²çš„æŸä¸ªå­ä¸²ï¼Œä½†æ˜¯ä¸ä¹‹å‰ä¸åŒçš„æ˜¯ï¼Œè¯¥åº“ç´¢å¼•çš„æ˜¯å­—ç¬¦ï¼Œè€Œä¸æ˜¯å­—èŠ‚.

**Example**

```rust
use utf8_slice;
fn main() {
    let s = "The ğŸš€ goes to the ğŸŒ‘!";

    let rocket = utf8_slice::slice(s, 4, 5);
    // ç»“æœæ˜¯ "ğŸš€"
}
```

## å­—ç¬¦ä¸²æ·±åº¦å‰–æ

å¯¹äº `String` ç±»å‹ï¼Œä¸ºäº†æ”¯æŒä¸€ä¸ªå¯å˜ã€å¯å¢é•¿çš„æ–‡æœ¬ç‰‡æ®µï¼Œéœ€è¦åœ¨å †ä¸Šåˆ†é…ä¸€å—åœ¨ç¼–è¯‘æ—¶æœªçŸ¥å¤§å°çš„å†…å­˜æ¥å­˜æ”¾å†…å®¹ï¼Œè¿™äº›éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶å®Œæˆçš„ï¼š

- é¦–å…ˆå‘æ“ä½œç³»ç»Ÿè¯·æ±‚å†…å­˜æ¥å­˜æ”¾ `String` å¯¹è±¡
- åœ¨ä½¿ç”¨å®Œæˆåï¼Œå°†å†…å­˜é‡Šæ”¾ï¼Œå½’è¿˜ç»™æ“ä½œç³»ç»Ÿ

å…¶ä¸­ç¬¬ä¸€éƒ¨åˆ†ç”± `String::from` å®Œæˆï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„ `String`ã€‚

é‡ç‚¹æ¥äº†ï¼Œåˆ°äº†ç¬¬äºŒéƒ¨åˆ†ï¼Œå°±æ˜¯ç™¾å®¶é½æ”¾çš„ç¯èŠ‚ï¼Œåœ¨æœ‰**åƒåœ¾å›æ”¶ GC** çš„è¯­è¨€ä¸­ï¼ŒGC æ¥è´Ÿè´£æ ‡è®°å¹¶æ¸…é™¤è¿™äº›ä¸å†ä½¿ç”¨çš„å†…å­˜å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹éƒ½æ˜¯è‡ªåŠ¨å®Œæˆï¼Œæ— éœ€å¼€å‘è€…å…³å¿ƒï¼Œéå¸¸ç®€å•å¥½ç”¨ï¼›ä½†æ˜¯åœ¨æ—  GC çš„è¯­è¨€ä¸­ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨å»é‡Šæ”¾è¿™äº›å†…å­˜å¯¹è±¡ï¼Œå°±åƒåˆ›å»ºå¯¹è±¡éœ€è¦é€šè¿‡ç¼–å†™ä»£ç æ¥å®Œæˆä¸€æ ·ï¼Œæœªèƒ½æ­£ç¡®é‡Šæ”¾å¯¹è±¡é€ æˆçš„åæœç®€ç›´ä¸å¯ä¼°é‡ã€‚

å¯¹äº Rust è€Œè¨€ï¼Œå˜é‡åœ¨ç¦»å¼€ä½œç”¨åŸŸåï¼Œå°±è‡ªåŠ¨é‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ï¼š

```rust
{
    let s = String::from("hello"); // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

    // ä½¿ç”¨ s
}                                  // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œ
                                   // s ä¸å†æœ‰æ•ˆï¼Œå†…å­˜è¢«é‡Šæ”¾
```

ä¸å…¶å®ƒç³»ç»Ÿç¼–ç¨‹è¯­è¨€çš„ `free` å‡½æ•°ç›¸åŒï¼ŒRust ä¹Ÿæä¾›äº†ä¸€ä¸ªé‡Šæ”¾å†…å­˜çš„å‡½æ•°ï¼š `drop`ï¼Œä½†æ˜¯ä¸åŒçš„æ˜¯ï¼Œå…¶å®ƒè¯­è¨€è¦æ‰‹åŠ¨è°ƒç”¨ `free` æ¥é‡Šæ”¾æ¯ä¸€ä¸ªå˜é‡å ç”¨çš„å†…å­˜ï¼Œ**è€Œ Rust åˆ™åœ¨å˜é‡ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨ `drop` å‡½æ•°: ä¸Šé¢ä»£ç ä¸­ï¼ŒRust åœ¨ç»“å°¾çš„ `}` å¤„è‡ªåŠ¨è°ƒç”¨ `drop`**ã€‚

> å…¶å®ï¼Œåœ¨ C++ ä¸­ï¼Œä¹Ÿæœ‰è¿™ç§æ¦‚å¿µ: *Resource Acquisition Is Initialization (RAII)*ã€‚å¦‚æœä½ ä½¿ç”¨è¿‡ RAII æ¨¡å¼çš„è¯åº”è¯¥å¯¹ Rust çš„ `drop` å‡½æ•°å¹¶ä¸é™Œç”Ÿ

## Practice_TODO

```rust
fn main() {
    let s: Box<str> = "hello, world".into();
    greetings(&s)
 }
 
 fn greetings(s: &str) {
     println!("{}",s)
 }
```

 ```rust
fn main() {
    let s: Box<&str> = "hello, world".into();
    greetings(*s)
}

fn greetings(s: &str) {
    println!("{}", s);
}
 ```

```rust
fn main() {
    let mut s = String::from("hello");
     s.push(',');
     s.push_str(" world");
     s += "!";
 
     println!("{}", s)
 }
```

```rust
fn main() {
    let s1 = String::from("hello,");
    let s2 = String::from("world!");
    let s3 = s1.clone() + &s2; 
    assert_eq!(s3,"hello,world!");
    println!("{}",s1);
}
```

```rust
fn main() {
    let s = "hello, world".to_string();
    let s1: &str = &s;
}
fn main() {
    let s = "hello, world";
    let s1: &str = s;
}
fn main() {
    let s = "hello, world".to_string();
    let s1: String = s;
}
```

# å…ƒç»„

å…ƒç»„æ˜¯ç”±å¤šç§ç±»å‹ç»„åˆåˆ°ä¸€èµ·å½¢æˆçš„ï¼Œå› æ­¤å®ƒæ˜¯å¤åˆç±»å‹ï¼Œå…ƒç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œå…ƒç»„ä¸­å…ƒç´ çš„é¡ºåºä¹Ÿæ˜¯å›ºå®šçš„ã€‚

å¯ä»¥é€šè¿‡ä»¥ä¸‹è¯­æ³•åˆ›å»ºä¸€ä¸ªå…ƒç»„ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

å˜é‡ `tup` è¢«ç»‘å®šäº†ä¸€ä¸ªå…ƒç»„å€¼ `(500, 6.4, 1)`ï¼Œè¯¥å…ƒç»„çš„ç±»å‹æ˜¯ `(i32, f64, u8)`ï¼Œå…ƒç»„æ˜¯ç”¨æ‹¬å·å°†å¤šä¸ªç±»å‹ç»„åˆåˆ°ä¸€èµ·ã€‚

å¯ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…æˆ–è€… `.` æ“ä½œç¬¦æ¥è·å–å…ƒç»„ä¸­çš„å€¼ã€‚ï¼ˆï¼‰æ˜¯ç©ºå…ƒç»„ã€‚

## ç”¨æ¨¡å¼åŒ¹é…è§£æ„å…ƒç»„

```rust
fn main() {
    let tup = (500, 6.4, 1);
    let (x, y, z) = tup;
    println!("The value of y is: {}", y);
}
```

ä¸Šè¿°ä»£ç é¦–å…ˆåˆ›å»ºä¸€ä¸ªå…ƒç»„ï¼Œç„¶åå°†å…¶ç»‘å®šåˆ° `tup` ä¸Šï¼Œæ¥ç€ä½¿ç”¨ `let (x, y, z) = tup;` æ¥å®Œæˆä¸€æ¬¡æ¨¡å¼åŒ¹é…ï¼Œå› ä¸ºå…ƒç»„æ˜¯ `(n1, n2, n3)` å½¢å¼çš„ï¼Œå› æ­¤æˆ‘ä»¬ç”¨ä¸€æ¨¡ä¸€æ ·çš„ `(x, y, z)` å½¢å¼æ¥è¿›è¡ŒåŒ¹é…ï¼Œå…ƒç»„ä¸­å¯¹åº”çš„å€¼ä¼šç»‘å®šåˆ°å˜é‡ `x`ï¼Œ `y`ï¼Œ `z`ä¸Šã€‚è¿™å°±æ˜¯è§£æ„ï¼šç”¨åŒæ ·çš„å½¢å¼æŠŠä¸€ä¸ªå¤æ‚å¯¹è±¡ä¸­çš„å€¼åŒ¹é…å‡ºæ¥ã€‚

## ç”¨ `.` æ¥è®¿é—®å…ƒç»„

æ¨¡å¼åŒ¹é…å¯ä»¥è®©æˆ‘ä»¬ä¸€æ¬¡æ€§æŠŠå…ƒç»„ä¸­çš„å€¼å…¨éƒ¨æˆ–è€…éƒ¨åˆ†è·å–å‡ºæ¥ï¼Œå¦‚æœåªæƒ³è¦è®¿é—®æŸä¸ªç‰¹å®šå…ƒç´ ï¼Œé‚£æ¨¡å¼åŒ¹é…å°±ç•¥æ˜¾ç¹çï¼Œå¯¹æ­¤ï¼ŒRust æä¾›äº† `.` çš„è®¿é—®æ–¹å¼ï¼š

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);
    let five_hundred = x.0;
    let six_point_four = x.1;
    let one = x.2;
}
```

å’Œå…¶å®ƒè¯­è¨€çš„æ•°ç»„ã€å­—ç¬¦ä¸²ä¸€æ ·ï¼Œå…ƒç»„çš„ç´¢å¼•ä» 0 å¼€å§‹ã€‚

## å…ƒç»„çš„ä½¿ç”¨ç¤ºä¾‹

å…ƒç»„åœ¨å‡½æ•°è¿”å›å€¼åœºæ™¯å¾ˆå¸¸ç”¨ï¼Œä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼Œå¯ä»¥**ä½¿ç”¨å…ƒç»„è¿”å›å¤šä¸ªå€¼**ï¼š

```rust
fn main() {
    let s1 = String::from("hello");
    let (s2, len) = calculate_length(s1);
    println!("The length of '{}' is {}.", s2, len);
}

fn calculate_length(s: String) -> (String, usize) {
    let length = s.len(); // len() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦

    (s, length)
}
```

`calculate_length` å‡½æ•°**æ¥æ”¶ `s1` å­—ç¬¦ä¸²çš„æ‰€æœ‰æƒ**ï¼Œç„¶åè®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæ¥ç€æŠŠå­—ç¬¦ä¸²æ‰€æœ‰æƒå’Œå­—ç¬¦ä¸²é•¿åº¦å†è¿”å›ç»™ `s2` å’Œ `len` å˜é‡ã€‚

åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œå¯ä»¥ç”¨ç»“æ„ä½“æ¥å£°æ˜ä¸€ä¸ªä¸‰ç»´ç©ºé—´ä¸­çš„ç‚¹ï¼Œä¾‹å¦‚ `Point(10, 20, 30)`ï¼Œè™½ç„¶ä½¿ç”¨ Rust å…ƒç»„ä¹Ÿå¯ä»¥åšåˆ°ï¼š`(10, 20, 30)`ï¼Œä½†æ˜¯è¿™æ ·å†™æœ‰ä¸ªéå¸¸é‡å¤§çš„ç¼ºé™·ï¼š

**ä¸å…·å¤‡ä»»ä½•æ¸…æ™°çš„å«ä¹‰**ï¼Œåœ¨ä¸‹ä¸€ç« èŠ‚ä¸­ï¼Œä¼šæåˆ°ä¸€ç§ä¸å…ƒç»„ç±»ä¼¼çš„ç»“æ„ä½“ï¼Œ`å…ƒç»„ç»“æ„ä½“`ï¼Œå¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

## Practice



# ç»“æ„ä½“

ä¸Šä¸€èŠ‚ä¸­æåˆ°éœ€è¦ä¸€ä¸ªæ›´é«˜çº§çš„æ•°æ®ç»“æ„æ¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„æŠ½è±¡é—®é¢˜ï¼Œç»“æ„ä½“ `struct` æ°æ°å°±æ˜¯è¿™æ ·çš„å¤åˆæ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯ç”±å…¶å®ƒæ•°æ®ç±»å‹ç»„åˆè€Œæ¥ã€‚ å…¶å®ƒè¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼çš„æ•°æ®ç»“æ„ï¼Œä¸è¿‡å¯èƒ½æœ‰ä¸åŒçš„åç§°ï¼Œä¾‹å¦‚ `object`ã€ `record` ç­‰ã€‚

ç»“æ„ä½“è·Ÿä¹‹å‰è®²è¿‡çš„[å…ƒç»„](https://course.rs/basic/compound-type/tuple.html)æœ‰äº›ç›¸åƒï¼šéƒ½æ˜¯ç”±å¤šç§ç±»å‹ç»„åˆè€Œæˆã€‚ä½†æ˜¯ä¸å…ƒç»„ä¸åŒçš„æ˜¯ï¼Œ**ç»“æ„ä½“å¯ä»¥ä¸ºå†…éƒ¨çš„æ¯ä¸ªå­—æ®µèµ·ä¸€ä¸ªå¯Œæœ‰å«ä¹‰çš„åç§°**ã€‚å› æ­¤ç»“æ„ä½“æ›´åŠ çµæ´»æ›´åŠ å¼ºå¤§ï¼Œä½ æ— éœ€ä¾èµ–è¿™äº›å­—æ®µçš„é¡ºåºæ¥è®¿é—®å’Œè§£æå®ƒä»¬ã€‚

## ç»“æ„ä½“è¯­æ³•

### å®šä¹‰ç»“æ„ä½“

ä¸€ä¸ªç»“æ„ä½“ç”±å‡ éƒ¨åˆ†ç»„æˆï¼š

- é€šè¿‡å…³é”®å­— `struct` å®šä¹‰
- ä¸€ä¸ªæ¸…æ™°æ˜ç¡®çš„ç»“æ„ä½“ `åç§°`
- å‡ ä¸ªæœ‰åå­—çš„ç»“æ„ä½“ `å­—æ®µ`

ä¾‹å¦‚, ä»¥ä¸‹ç»“æ„ä½“å®šä¹‰äº†æŸç½‘ç«™çš„ç”¨æˆ·ï¼š

```rust
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}
```

è¯¥ç»“æ„ä½“åç§°æ˜¯ `User`ï¼Œæ‹¥æœ‰ 4 ä¸ªå­—æ®µï¼Œä¸”æ¯ä¸ªå­—æ®µéƒ½æœ‰å¯¹åº”çš„å­—æ®µååŠç±»å‹å£°æ˜ï¼Œä¾‹å¦‚ `username` ä»£è¡¨äº†ç”¨æˆ·åï¼Œæ˜¯ä¸€ä¸ªå¯å˜çš„ `String` ç±»å‹ã€‚

### åˆ›å»ºç»“æ„ä½“å®ä¾‹

ä¸ºäº†ä½¿ç”¨ä¸Šè¿°ç»“æ„ä½“ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»º `User` ç»“æ„ä½“çš„**å®ä¾‹**ï¼š

```rust
let user1 = User {
    email: String::from("someone@example.com"),
    username: String::from("someusername123"),
    active: true,
    sign_in_count: 1,
};
```

æ³¨æ„:

1. åˆå§‹åŒ–å®ä¾‹æ—¶ï¼Œ**æ¯ä¸ªå­—æ®µ**éƒ½éœ€è¦è¿›è¡Œåˆå§‹åŒ–
2. åˆå§‹åŒ–æ—¶çš„å­—æ®µé¡ºåº**ä¸éœ€è¦**å’Œç»“æ„ä½“å®šä¹‰æ—¶çš„é¡ºåºä¸€è‡´

### è®¿é—®ç»“æ„ä½“å­—æ®µ

é€šè¿‡ `.` æ“ä½œç¬¦å³å¯è®¿é—®ç»“æ„ä½“å®ä¾‹å†…éƒ¨çš„å­—æ®µå€¼ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹å®ƒä»¬ï¼š

```rust
let mut user1 = User {
    email: String::from("someone@example.com"),
    username: String::from("someusername123"),
    active: true,
    sign_in_count: 1,
};

user1.email = String::from("anotheremail@example.com");
```

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ**å¿…é¡»è¦å°†ç»“æ„ä½“å®ä¾‹å£°æ˜ä¸ºå¯å˜çš„**ï¼Œæ‰èƒ½ä¿®æ”¹å…¶ä¸­çš„å­—æ®µï¼ŒRust **ä¸æ”¯æŒå°†æŸä¸ªç»“æ„ä½“æŸä¸ªå­—æ®µæ ‡è®°ä¸ºå¯å˜**ã€‚

### ç®€åŒ–ç»“æ„ä½“åˆ›å»º

ä¸‹é¢çš„å‡½æ•°ç±»ä¼¼ä¸€ä¸ªæ„å»ºå‡½æ•°ï¼Œè¿”å›äº† `User` ç»“æ„ä½“çš„å®ä¾‹ï¼š

```rust
fn build_user(email: String, username: String) -> User {
    User {
        email: email,
        username: username,
        active: true,
        sign_in_count: 1,
    }
}
```

å®ƒæ¥æ”¶ä¸¤ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼š `email` å’Œ `username`ï¼Œç„¶åä½¿ç”¨å®ƒä»¬æ¥åˆ›å»ºä¸€ä¸ª `User` ç»“æ„ä½“ï¼Œå¹¶ä¸”è¿”å›ã€‚

å½“å‡½æ•°å‚æ•°å’Œç»“æ„ä½“å­—æ®µåŒåæ—¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç¼©ç•¥çš„æ–¹å¼è¿›è¡Œåˆå§‹åŒ–ï¼š

```rust
fn build_user(email: String, username: String) -> User {
    User {
        email,
        username,
        active: true,
        sign_in_count: 1,
    }
}
```

### ç»“æ„ä½“æ›´æ–°è¯­æ³•

åœ¨å®é™…åœºæ™¯ä¸­ï¼Œæœ‰ä¸€ç§æƒ…å†µå¾ˆå¸¸è§ï¼šæ ¹æ®å·²æœ‰çš„ç»“æ„ä½“å®ä¾‹ï¼Œåˆ›å»ºæ–°çš„ç»“æ„ä½“å®ä¾‹ï¼Œä¾‹å¦‚æ ¹æ®å·²æœ‰çš„ `user1` å®ä¾‹æ¥æ„å»º `user2`ï¼š

```rust
  let user2 = User {
        active: user1.active,
        username: user1.username,
        email: String::from("another@example.com"),
        sign_in_count: user1.sign_in_count,
    };
```

Rust ä¸ºæˆ‘ä»¬æä¾›äº† `ç»“æ„ä½“æ›´æ–°è¯­æ³•`ï¼š

```rust
  let user2 = User {
        email: String::from("another@example.com"),
        ..user1
    };
```

å› ä¸º `user2` ä»…ä»…åœ¨ `email` ä¸Šä¸ `user1` ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å¯¹ `email` è¿›è¡Œèµ‹å€¼ï¼Œå‰©ä¸‹çš„é€šè¿‡ç»“æ„ä½“æ›´æ–°è¯­æ³• `..user1` å³å¯å®Œæˆã€‚

`..` è¯­æ³•è¡¨æ˜å‡¡æ˜¯æˆ‘ä»¬æ²¡æœ‰æ˜¾ç¤ºå£°æ˜çš„å­—æ®µï¼Œå…¨éƒ¨ä» `user1` ä¸­è‡ªåŠ¨è·å–ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ **`..user1` å¿…é¡»åœ¨ç»“æ„ä½“çš„å°¾éƒ¨ä½¿ç”¨**ã€‚

> ç»“æ„ä½“æ›´æ–°è¯­æ³•è·Ÿèµ‹å€¼è¯­å¥ `=` éå¸¸ç›¸åƒï¼Œå› æ­¤åœ¨ä¸Šé¢ä»£ç ä¸­ï¼Œ`user1` çš„éƒ¨åˆ†å­—æ®µæ‰€æœ‰æƒè¢«è½¬ç§»åˆ° `user2` ä¸­ï¼š`username` å­—æ®µå‘ç”Ÿäº†æ‰€æœ‰æƒè½¬ç§»ï¼Œä½œä¸ºç»“æœï¼Œ`user1` æ— æ³•å†è¢«ä½¿ç”¨ã€‚
>
> èªæ˜çš„è¯»è€…è‚¯å®šè¦å‘é—®äº†ï¼šæ˜æ˜æœ‰ä¸‰ä¸ªå­—æ®µè¿›è¡Œäº†è‡ªåŠ¨èµ‹å€¼ï¼Œä¸ºä½•åªæœ‰ `username` å‘ç”Ÿäº†æ‰€æœ‰æƒè½¬ç§»ï¼Ÿ
>
> ä»”ç»†å›æƒ³ä¸€ä¸‹[æ‰€æœ‰æƒ](https://course.rs/basic/ownership/ownership.html#æ‹·è´æµ…æ‹·è´)é‚£ä¸€èŠ‚çš„å†…å®¹ï¼Œæˆ‘ä»¬æåˆ°äº† `Copy` ç‰¹å¾ï¼š**å®ç°äº† `Copy` ç‰¹å¾çš„ç±»å‹æ— éœ€æ‰€æœ‰æƒè½¬ç§»ï¼Œå¯ä»¥ç›´æ¥åœ¨èµ‹å€¼æ—¶è¿›è¡Œ æ•°æ®æ‹·è´ï¼Œå…¶ä¸­ `bool` å’Œ `u64` ç±»å‹å°±å®ç°äº† `Copy` ç‰¹å¾**ï¼Œå› æ­¤ `active` å’Œ `sign_in_count` å­—æ®µåœ¨èµ‹å€¼ç»™ `user2` æ—¶ï¼Œä»…ä»…å‘ç”Ÿäº†æ‹·è´ï¼Œè€Œä¸æ˜¯æ‰€æœ‰æƒè½¬ç§»ã€‚
>
> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š**`username` æ‰€æœ‰æƒè¢«è½¬ç§»ç»™äº† `user2`ï¼Œå¯¼è‡´äº† `user1` æ— æ³•å†è¢«ä½¿ç”¨ï¼Œä½†æ˜¯å¹¶ä¸ä»£è¡¨ `user1` å†…éƒ¨çš„å…¶å®ƒå­—æ®µä¸èƒ½è¢«ç»§ç»­ä½¿ç”¨**ï¼Œä¾‹å¦‚ï¼š

```rust
let user1 = User {
    email: String::from("someone@example.com"),
    username: String::from("someusername123"),
    active: true,
    sign_in_count: 1,
};
let user2 = User {
    active: user1.active,
    username: user1.username,
    email: String::from("another@example.com"),
    sign_in_count: user1.sign_in_count,
};
println!("{}", user1.active);
// ä¸‹é¢è¿™è¡Œä¼šæŠ¥é”™
println!("{:?}", user1);
```

## ç»“æ„ä½“çš„å†…å­˜æ’åˆ—

å…ˆæ¥çœ‹ä»¥ä¸‹ä»£ç ï¼š

```rust
#[derive(Debug)]
struct File {
    name: String,
    data: Vec<u8>,
}

fn main() {
    let f1 = File {
        name: String::from("f1.txt"),
        data: Vec::new(),
    };

    let f1_name = &f1.name;
    let f1_length = &f1.data.len();

    println!("{:?}", f1);
    println!("{} is {} bytes long", f1_name, f1_length);
}
```

ä¸Šé¢å®šä¹‰çš„ `File` ç»“æ„ä½“åœ¨å†…å­˜ä¸­çš„æ’åˆ—å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

 ![img](https://pic3.zhimg.com/80/v2-8cc4ed8cd06d60f974d06ca2199b8df5_1440w.png)

ä»å›¾ä¸­å¯ä»¥æ¸…æ™°çš„çœ‹å‡º `File` ç»“æ„ä½“**ä¸¤ä¸ªå­—æ®µ `name` å’Œ `data` åˆ†åˆ«æ‹¥æœ‰åº•å±‚ä¸¤ä¸ª `[u8]` æ•°ç»„çš„æ‰€æœ‰æƒ**(`String` ç±»å‹çš„åº•å±‚ä¹Ÿæ˜¯ `[u8]` æ•°ç»„)ï¼Œé€šè¿‡ `ptr` æŒ‡é’ˆæŒ‡å‘åº•å±‚æ•°ç»„çš„å†…å­˜åœ°å€ï¼Œè¿™é‡Œä½ å¯ä»¥æŠŠ `ptr` æŒ‡é’ˆç†è§£ä¸º Rust ä¸­çš„å¼•ç”¨ç±»å‹ã€‚

è¯¥å›¾ç‰‡ä¹Ÿä¾§é¢å°è¯äº†ï¼š**æŠŠç»“æ„ä½“ä¸­å…·æœ‰æ‰€æœ‰æƒçš„å­—æ®µè½¬ç§»å‡ºå»åï¼Œå°†æ— æ³•å†è®¿é—®è¯¥å­—æ®µï¼Œä½†æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®å…¶å®ƒçš„å­—æ®µ**ã€‚

## å…ƒç»„ç»“æ„ä½“(Tuple Struct)

ç»“æ„ä½“å¿…é¡»è¦æœ‰åç§°ï¼Œä½†æ˜¯ç»“æ„ä½“çš„å­—æ®µå¯ä»¥æ²¡æœ‰åç§°ï¼Œè¿™ç§ç»“æ„ä½“é•¿å¾—å¾ˆåƒå…ƒç»„ï¼Œå› æ­¤è¢«ç§°ä¸ºå…ƒç»„ç»“æ„ä½“ï¼Œä¾‹å¦‚ï¼š

```rust
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

let black = Color(0, 0, 0);
let origin = Point(0, 0, 0);
```

**å…ƒç»„ç»“æ„ä½“åœ¨ä½ å¸Œæœ›æœ‰ä¸€ä¸ªæ•´ä½“åç§°ï¼Œä½†æ˜¯åˆä¸å…³å¿ƒé‡Œé¢å­—æ®µçš„åç§°æ—¶å°†éå¸¸æœ‰ç”¨**ã€‚ä¾‹å¦‚ä¸Šé¢çš„ `Point` å…ƒç»„ç»“æ„ä½“ï¼Œä¼—æ‰€å‘¨çŸ¥ 3D ç‚¹æ˜¯ `(x, y, z)` å½¢å¼çš„åæ ‡ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬æ— éœ€å†ä¸ºå†…éƒ¨çš„å­—æ®µé€ä¸€å‘½åä¸ºï¼š`x`, `y`, `z`ã€‚

## å•å…ƒç»“æ„ä½“(Unit-like Struct)

è¿˜è®°å¾—ä¹‹å‰è®²è¿‡çš„åŸºæœ¬æ²¡å•¥ç”¨çš„[å•å…ƒç±»å‹](https://course.rs/basic/base-type/char-bool.html#å•å…ƒç±»å‹)å§ï¼Ÿå•å…ƒç»“æ„ä½“å°±è·Ÿå®ƒå¾ˆåƒï¼Œæ²¡æœ‰ä»»ä½•å­—æ®µå’Œå±æ€§ï¼Œä½†æ˜¯å¥½åœ¨ï¼Œå®ƒè¿˜æŒºæœ‰ç”¨ã€‚

**å¦‚æœä½ å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œä½†æ˜¯ä¸å…³å¿ƒè¯¥ç±»å‹çš„å†…å®¹, åªå…³å¿ƒå®ƒçš„è¡Œä¸ºæ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ `å•å…ƒç»“æ„ä½“`**ï¼š

```rust
struct AlwaysEqual;

let subject = AlwaysEqual;

// æˆ‘ä»¬ä¸å…³å¿ƒ AlwaysEqual çš„å­—æ®µæ•°æ®ï¼Œåªå…³å¿ƒå®ƒçš„è¡Œä¸ºï¼Œå› æ­¤å°†å®ƒå£°æ˜ä¸ºå•å…ƒç»“æ„ä½“ï¼Œç„¶åå†ä¸ºå®ƒå®ç°æŸä¸ªç‰¹å¾
impl SomeTrait for AlwaysEqual {

}
```

## ç»“æ„ä½“æ•°æ®çš„æ‰€æœ‰æƒ

åœ¨ä¹‹å‰çš„ `User` ç»“æ„ä½“çš„å®šä¹‰ä¸­ï¼Œæœ‰ä¸€å¤„ç»†èŠ‚ï¼šæˆ‘ä»¬ä½¿ç”¨äº†è‡ªèº«æ‹¥æœ‰æ‰€æœ‰æƒçš„ `String` ç±»å‹è€Œä¸æ˜¯åŸºäºå¼•ç”¨çš„ `&str` å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æ„è€Œä¸ºä¹‹çš„é€‰æ‹©ï¼š**å› ä¸ºæˆ‘ä»¬æƒ³è¦è¿™ä¸ªç»“æ„ä½“æ‹¥æœ‰å®ƒæ‰€æœ‰çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä»å…¶å®ƒåœ°æ–¹å€Ÿç”¨æ•°æ®**ã€‚

**ä¹Ÿå¯ä»¥è®© `User` ç»“æ„ä½“ä»å…¶å®ƒå¯¹è±¡å€Ÿç”¨æ•°æ®ï¼Œä¸è¿‡è¿™ä¹ˆåšï¼Œå°±éœ€è¦å¼•å…¥[ç”Ÿå‘½å‘¨æœŸ(lifetimes)](https://course.rs/advance/lifetime/basic.html)è¿™ä¸ªæ¦‚å¿µ**ï¼Œç”Ÿå‘½å‘¨æœŸèƒ½ç¡®ä¿ç»“æ„ä½“çš„ä½œç”¨èŒƒå›´è¦æ¯”å®ƒæ‰€å€Ÿç”¨çš„æ•°æ®çš„ä½œç”¨èŒƒå›´è¦å°ã€‚

æ€»ä¹‹ï¼Œå¦‚æœä½ æƒ³åœ¨ç»“æ„ä½“ä¸­ä½¿ç”¨ä¸€ä¸ªå¼•ç”¨ï¼Œå°±å¿…é¡»åŠ ä¸Šç”Ÿå‘½å‘¨æœŸï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ï¼š

```rust
struct User {
    username: &str,
    email: &str,
    sign_in_count: u64,
    active: bool,
}

fn main() {
    let user1 = User {
        email: "someone@example.com",
        username: "someusername123",
        active: true,
        sign_in_count: 1,
    };
}
```

ç¼–è¯‘å™¨ä¼šæŠ±æ€¨å®ƒéœ€è¦ç”Ÿå‘½å‘¨æœŸæ ‡è¯†ç¬¦ï¼š

```console
error[E0106]: missing lifetime specifier
 --> src/main.rs:2:15
  |
2 |     username: &str,
  |               ^ expected named lifetime parameter // éœ€è¦ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ
  |
help: consider introducing a named lifetime parameter // è€ƒè™‘åƒä¸‹é¢çš„ä»£ç è¿™æ ·å¼•å…¥ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸ
  |
1 ~ struct User<'a> {
2 ~     username: &'a str,
  |

error[E0106]: missing lifetime specifier
 --> src/main.rs:3:12
  |
3 |     email: &str,
  |            ^ expected named lifetime parameter
  |
help: consider introducing a named lifetime parameter
  |
1 ~ struct User<'a> {
2 |     username: &str,
3 ~     email: &'a str,
  |
```

## ä½¿ç”¨ `#[derive(Debug)\]` æ¥æ‰“å°ç»“æ„ä½“çš„ä¿¡æ¯

åœ¨å‰é¢çš„ä»£ç ä¸­æˆ‘ä»¬ä½¿ç”¨ `#[derive(Debug)]` å¯¹ç»“æ„ä½“è¿›è¡Œäº†æ ‡è®°ï¼Œè¿™æ ·æ‰èƒ½ä½¿ç”¨ `println!("{:?}", s);` çš„æ–¹å¼å¯¹å…¶è¿›è¡Œæ‰“å°è¾“å‡ºï¼Œå¦‚æœä¸åŠ ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ:

```rust
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {}", rect1);
}
```

é¦–å…ˆå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œä¸Šé¢ä½¿ç”¨äº† `{}` è€Œä¸æ˜¯ä¹‹å‰çš„ `{:?}`ï¼Œè¿è¡ŒåæŠ¥é”™ï¼š

```shell
error[E0277]: `Rectangle` doesn't implement `std::fmt::Display`
```

æç¤ºæˆ‘ä»¬ç»“æ„ä½“ `Rectangle` **æ²¡æœ‰å®ç° `Display` ç‰¹å¾**ï¼Œè¿™æ˜¯å› ä¸ºå¦‚æœæˆ‘ä»¬ä½¿ç”¨ `{}` æ¥æ ¼å¼åŒ–è¾“å‡ºï¼Œé‚£å¯¹åº”çš„ç±»å‹å°±å¿…é¡»å®ç° `Display` ç‰¹å¾ï¼Œä»¥å‰å­¦ä¹ çš„åŸºæœ¬ç±»å‹ï¼Œéƒ½é»˜è®¤å®ç°äº†è¯¥ç‰¹å¾:

```rust
fn main() {
    let v = 1;
    let b = true;

    println!("{}, {}", v, b);
}
```

ä¸Šé¢ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œé‚£ä¹ˆç»“æ„ä½“ä¸ºä»€ä¹ˆä¸é»˜è®¤å®ç° `Display` ç‰¹å¾å‘¢ï¼ŸåŸå› åœ¨äºç»“æ„ä½“è¾ƒä¸ºå¤æ‚ï¼Œä¾‹å¦‚è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼šä½ æƒ³è¦é€—å·å¯¹å­—æ®µè¿›è¡Œåˆ†å‰²å—ï¼Ÿéœ€è¦æ‹¬å·å—ï¼ŸåŠ åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿæ‰€æœ‰çš„å­—æ®µéƒ½åº”è¯¥æ˜¾ç¤ºï¼Ÿç±»ä¼¼çš„è¿˜æœ‰å¾ˆå¤šï¼Œ**ç”±äºè¿™ç§å¤æ‚æ€§ï¼ŒRust ä¸å¸Œæœ›çŒœæµ‹æˆ‘ä»¬æƒ³è¦çš„æ˜¯ä»€ä¹ˆ**ï¼Œè€Œæ˜¯æŠŠé€‰æ‹©æƒäº¤ç»™æˆ‘ä»¬è‡ªå·±æ¥å®ç°ï¼šå¦‚æœè¦ç”¨ `{}` çš„æ–¹å¼æ‰“å°ç»“æ„ä½“ï¼Œé‚£å°±è‡ªå·±å®ç° `Display` ç‰¹å¾ã€‚

æ¥ä¸‹æ¥ç»§ç»­é˜…è¯»æŠ¥é”™ï¼š

```shell
= help: the trait `std::fmt::Display` is not implemented for `Rectangle`
= note: in format strings you may be able to use `{:?}` (or {:#?} for pretty-print) instead
```

ä¸Šé¢æç¤ºæˆ‘ä»¬ä½¿ç”¨ `{:?}` æ¥è¯•è¯•ï¼Œè¿™ä¸ªæ–¹å¼æˆ‘ä»¬åœ¨æœ¬æ–‡çš„å‰é¢ä¹Ÿè§è¿‡ï¼Œä¸‹é¢æ¥è¯•è¯•:

```rust
println!("rect1 is {:?}", rect1);
```

å¯æ˜¯ä¾ç„¶æ— æƒ…æŠ¥é”™äº†:

```shell
error[E0277]: `Rectangle` doesn't implement `Debug`
```

å¥½åœ¨ï¼Œèªæ˜çš„ç¼–è¯‘å™¨åˆä¸€æ¬¡ç»™å‡ºäº†æç¤º:

```shell
= help: the trait `Debug` is not implemented for `Rectangle`
= note: add `#[derive(Debug)]` to `Rectangle` or manually `impl Debug for Rectangle`
```

è®©æˆ‘ä»¬å®ç° `Debug` ç‰¹å¾ï¼Œå°±æ˜¯ä¸æƒ³å®ç° `Display` ç‰¹å¾ï¼Œæ‰ç”¨çš„ `{:?}`ï¼Œæ€ä¹ˆåˆè¦å®ç° `Debug`ã€‚

é¦–å…ˆï¼ŒRust é»˜è®¤ä¸ä¼šä¸ºæˆ‘ä»¬å®ç° `Debug`ï¼Œä¸ºäº†å®ç°ï¼Œæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥é€‰æ‹©ï¼š

- æ‰‹åŠ¨å®ç°
- ä½¿ç”¨ `derive` æ´¾ç”Ÿå®ç°

åè€…ç®€å•çš„å¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰é™åˆ¶ï¼Œå…·ä½“è§[é™„å½• D](https://course.rs/appendix/derive.html)ï¼Œæ¥çœ‹çœ‹è¯¥å¦‚ä½•ä½¿ç”¨:

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let rect1 = Rectangle {
        width: 30,
        height: 50,
    };

    println!("rect1 is {:?}", rect1);
}
```

æ­¤æ—¶è¿è¡Œç¨‹åºï¼Œå°±ä¸å†æœ‰é”™è¯¯ï¼Œè¾“å‡ºå¦‚ä¸‹:

```shell
$ cargo run
rect1 is Rectangle { width: 30, height: 50 }
```

è¿™ä¸ªè¾“å‡ºæ ¼å¼çœ‹ä¸Šå»ä¹Ÿä¸èµ–å˜›ï¼Œè™½ç„¶æœªå¿…æ˜¯æœ€å¥½çš„ã€‚è¿™ç§æ ¼å¼æ˜¯ Rust è‡ªåŠ¨ä¸ºæˆ‘ä»¬æä¾›çš„å®ç°ï¼Œçœ‹ä¸ŠåŸºæœ¬å°±è·Ÿç»“æ„ä½“çš„å®šä¹‰å½¢å¼ä¸€æ ·ã€‚

**å½“ç»“æ„ä½“è¾ƒå¤§æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›èƒ½å¤Ÿæœ‰æ›´å¥½çš„è¾“å‡ºè¡¨ç°ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ `{:#?}` æ¥æ›¿ä»£ `{:?}`**ï¼Œè¾“å‡ºå¦‚ä¸‹:

```shell
rect1 is Rectangle {
    width: 30,
    height: 50,
}
```

æ­¤æ—¶ç»“æ„ä½“çš„è¾“å‡ºè·Ÿæˆ‘ä»¬åˆ›å»ºæ—¶å€™çš„ä»£ç å‡ ä¹ä¸€æ¨¡ä¸€æ ·äº†ï¼å½“ç„¶ï¼Œå¦‚æœå¤§å®¶è¿˜æ˜¯ä¸æ»¡è¶³ï¼Œé‚£æœ€å¥½è¿˜æ˜¯è‡ªå·±å®ç° `Display` ç‰¹å¾ï¼Œä»¥å‘ç”¨æˆ·æ›´ç¾çš„å±•ç¤ºä½ çš„ç§è—ç»“æ„ä½“ã€‚å…³äºæ ¼å¼åŒ–è¾“å‡ºçš„æ›´å¤šå†…å®¹ï¼Œæˆ‘ä»¬å¼ºçƒˆæ¨èçœ‹çœ‹è¿™ä¸ª[ç« èŠ‚](https://course.rs/basic/formatted-output.html#debug-ç‰¹å¾)ã€‚

è¿˜æœ‰ä¸€ä¸ªç®€å•çš„è¾“å‡º debug ä¿¡æ¯çš„æ–¹æ³•ï¼Œé‚£å°±æ˜¯ä½¿ç”¨ **[`dbg!` å®](https://doc.rust-lang.org/std/macro.dbg.html)ï¼Œå®ƒä¼šæ‹¿èµ°è¡¨è¾¾å¼çš„æ‰€æœ‰æƒ**ï¼Œç„¶åæ‰“å°å‡ºç›¸åº”çš„æ–‡ä»¶åã€è¡Œå·ç­‰ debug ä¿¡æ¯ï¼Œå½“ç„¶è¿˜æœ‰æˆ‘ä»¬éœ€è¦çš„è¡¨è¾¾å¼çš„æ±‚å€¼ç»“æœã€‚**å®ƒæœ€ç»ˆè¿˜ä¼šæŠŠè¡¨è¾¾å¼å€¼çš„æ‰€æœ‰æƒè¿”å›ï¼**

> `dbg!` è¾“å‡ºåˆ°æ ‡å‡†é”™è¯¯è¾“å‡º `stderr`ï¼Œè€Œ `println!` è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡º `stdout`

ä¸‹é¢çš„ä¾‹å­ä¸­æ¸…æ™°çš„å±•ç¤ºäº† `dbg!` å¦‚ä½•åœ¨æ‰“å°å‡ºä¿¡æ¯çš„åŒæ—¶ï¼Œè¿˜æŠŠè¡¨è¾¾å¼çš„å€¼èµ‹ç»™äº† `width`:

```rust
#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

fn main() {
    let scale = 2;
    let rect1 = Rectangle {
        width: dbg!(30 * scale),
        height: 50,
    };

    dbg!(&rect1);
}
```

æœ€ç»ˆçš„ debug è¾“å‡ºå¦‚ä¸‹:

```shell
$ cargo run
[src/main.rs:10] 30 * scale = 60
[src/main.rs:14] &rect1 = Rectangle {
    width: 60,
    height: 50,
}
```

å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬æƒ³è¦çš„ debug ä¿¡æ¯å‡ ä¹éƒ½æœ‰äº†ï¼šä»£ç æ‰€åœ¨çš„æ–‡ä»¶åã€è¡Œå·ã€è¡¨è¾¾å¼ä»¥åŠè¡¨è¾¾å¼çš„å€¼ï¼Œç®€ç›´å®Œç¾ï¼

## Practice



# æšä¸¾

æšä¸¾(enum æˆ– enumeration)å…è®¸ä½ é€šè¿‡åˆ—ä¸¾å¯èƒ½çš„æˆå‘˜æ¥å®šä¹‰ä¸€ä¸ª**æšä¸¾ç±»å‹**ï¼Œä¾‹å¦‚æ‰‘å…‹ç‰ŒèŠ±è‰²ï¼š

```rust
enum PokerSuit {
  Clubs,
  Spades,
  Diamonds,
  Hearts,
}
```

`æšä¸¾ç±»å‹` å’Œ `æšä¸¾å€¼` ï¼š **æšä¸¾ç±»å‹æ˜¯ä¸€ä¸ªç±»å‹ï¼Œå®ƒä¼šåŒ…å«æ‰€æœ‰å¯èƒ½çš„æšä¸¾æˆå‘˜, è€Œæšä¸¾å€¼æ˜¯è¯¥ç±»å‹ä¸­çš„å…·ä½“æŸä¸ªæˆå‘˜çš„å®ä¾‹ã€‚**

## æšä¸¾å€¼

ç°åœ¨æ¥åˆ›å»º `PokerSuit` æšä¸¾ç±»å‹çš„ä¸¤ä¸ªæˆå‘˜å®ä¾‹ï¼š

```rust
let heart = PokerSuit::Hearts;
let diamond = PokerSuit::Diamonds;
```

æˆ‘ä»¬é€šè¿‡ `::` æ“ä½œç¬¦æ¥è®¿é—® `PokerSuit` ä¸‹çš„å…·ä½“æˆå‘˜ï¼Œæ¥ç€å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥ä½¿ç”¨å®ƒä»¬ï¼š

```rust
fn main() {
    let heart = PokerSuit::Hearts;
    let diamond = PokerSuit::Diamonds;

    print_suit(heart);
    print_suit(diamond);
}

fn print_suit(card: PokerSuit) {
    println!("{:?}",card);
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æƒ³è®©æ‰‘å…‹ç‰Œå˜å¾—æ›´åŠ å®ç”¨ï¼Œé‚£ä¹ˆéœ€è¦ç»™æ¯å¼ ç‰Œèµ‹äºˆä¸€ä¸ªå€¼ï¼š`A`(1)-`K`(13)ï¼Œè¿™æ ·å†åŠ ä¸ŠèŠ±è‰²ï¼Œå°±æ˜¯ä¸€å¼ çœŸå®çš„æ‰‘å…‹ç‰Œäº†ï¼Œä¾‹å¦‚çº¢å¿ƒ Aã€‚

ç›®å‰æ¥è¯´ï¼Œ**æšä¸¾å€¼è¿˜ä¸èƒ½å¸¦æœ‰å€¼ï¼Œå› æ­¤å…ˆç”¨ç»“æ„ä½“æ¥å®ç°**ï¼š

```rust
enum PokerSuit {
    Clubs,
    Spades,
    Diamonds,
    Hearts,
}

struct PokerCard {
    suit: PokerSuit,
    value: u8
}

fn main() {
   let c1 = PokerCard {
       suit: PokerSuit::Clubs,
       value: 1,
   };
   let c2 = PokerCard {
       suit: PokerSuit::Diamonds,
       value: 12,
   };
}
```

è¿˜æœ‰ç®€æ´å¾—å¤šçš„æ–¹å¼æ¥å®ç°ï¼š

```rust
enum PokerCard {
    Clubs(u8),
    Spades(u8),
    Diamonds(u8),
    Hearts(u8),
}

fn main() {
   let c1 = PokerCard::Spades(5);
   let c2 = PokerCard::Diamonds(13);
}
```

ç›´æ¥å°†æ•°æ®ä¿¡æ¯å…³è”åˆ°æšä¸¾æˆå‘˜ä¸Šï¼Œçœå»è¿‘ä¸€åŠçš„ä»£ç ã€‚

ä¸ä»…å¦‚æ­¤ï¼ŒåŒä¸€ä¸ªæšä¸¾ç±»å‹ä¸‹çš„ä¸åŒæˆå‘˜è¿˜èƒ½æŒæœ‰ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚è®©æŸäº›èŠ±è‰²æ‰“å° `1-13` çš„å­—æ ·ï¼Œå¦å¤–çš„èŠ±è‰²æ‰“å°ä¸Š `A-K` çš„å­—æ ·ï¼š

```rust
enum PokerCard {
    Clubs(u8),
    Spades(u8),
    Diamonds(char),
    Hearts(char),
}

fn main() {
   let c1 = PokerCard::Spades(5);
   let c2 = PokerCard::Diamonds('A');
}
```

å†æ¥çœ‹ä¸€ä¸ªæ¥è‡ªæ ‡å‡†åº“ä¸­çš„ä¾‹å­ï¼š

```rust
struct Ipv4Addr {
    // --snip--
}

struct Ipv6Addr {
    // --snip--
}

enum IpAddr {
    V4(Ipv4Addr),
    V6(Ipv6Addr),
}
```

è¿™ä¸ªä¾‹å­è·Ÿæˆ‘ä»¬ä¹‹å‰çš„æ‰‘å…‹ç‰Œå¾ˆåƒï¼Œåªä¸è¿‡æšä¸¾æˆå‘˜åŒ…å«çš„ç±»å‹æ›´å¤æ‚äº†ï¼Œå˜æˆäº†ç»“æ„ä½“ï¼šåˆ†åˆ«é€šè¿‡ `Ipv4Addr` å’Œ `Ipv6Addr` æ¥å®šä¹‰ä¸¤ç§ä¸åŒçš„ IP æ•°æ®ã€‚

ä»è¿™äº›ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œ**ä»»ä½•ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥æ”¾å…¥æšä¸¾æˆå‘˜ä¸­**: ä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•°å€¼ã€ç»“æ„ä½“ç”šè‡³å¦ä¸€ä¸ªæšä¸¾ã€‚

å¢åŠ ä¸€äº›æŒ‘æˆ˜ï¼Ÿå…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š

```rust
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn main() {
    let m1 = Message::Quit;
    let m2 = Message::Move{x:1,y:1};
    let m3 = Message::ChangeColor(255,255,0);
}
```

è¯¥æšä¸¾ç±»å‹ä»£è¡¨ä¸€æ¡æ¶ˆæ¯ï¼Œå®ƒåŒ…å«å››ä¸ªä¸åŒçš„æˆå‘˜ï¼š

- `Quit` æ²¡æœ‰ä»»ä½•å…³è”æ•°æ®
- `Move` åŒ…å«ä¸€ä¸ªåŒ¿åç»“æ„ä½“
- `Write` åŒ…å«ä¸€ä¸ª `String` å­—ç¬¦ä¸²
- `ChangeColor` åŒ…å«ä¸‰ä¸ª `i32`

å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç»“æ„ä½“çš„æ–¹å¼æ¥å®šä¹‰è¿™äº›æ¶ˆæ¯ï¼š

```rust
struct QuitMessage; // å•å…ƒç»“æ„ä½“
struct MoveMessage {
    x: i32,
    y: i32,
}
struct WriteMessage(String); // å…ƒç»„ç»“æ„ä½“
struct ChangeColorMessage(i32, i32, i32); // å…ƒç»„ç»“æ„ä½“
```

**ç”±äºæ¯ä¸ªç»“æ„ä½“éƒ½æœ‰è‡ªå·±çš„ç±»å‹ï¼Œå› æ­¤æˆ‘ä»¬æ— æ³•åœ¨éœ€è¦åŒä¸€ç±»å‹çš„åœ°æ–¹è¿›è¡Œä½¿ç”¨**ï¼Œä¾‹å¦‚æŸä¸ªå‡½æ•°å®ƒçš„åŠŸèƒ½æ˜¯æ¥å—æ¶ˆæ¯å¹¶è¿›è¡Œå‘é€ï¼Œé‚£ä¹ˆç”¨æšä¸¾çš„æ–¹å¼ï¼Œå°±å¯ä»¥æ¥æ”¶ä¸åŒçš„æ¶ˆæ¯ï¼Œä½†æ˜¯ç”¨ç»“æ„ä½“ï¼Œè¯¥å‡½æ•°æ— æ³•æ¥å— 4 ä¸ªä¸åŒçš„ç»“æ„ä½“ä½œä¸ºå‚æ•°ã€‚

è€Œä¸”ä»ä»£ç è§„èŒƒè§’åº¦æ¥çœ‹ï¼Œæšä¸¾çš„å®ç°æ›´ç®€æ´ï¼Œä»£ç å†…èšæ€§æ›´å¼ºï¼Œä¸åƒç»“æ„ä½“çš„å®ç°ï¼Œåˆ†æ•£åœ¨å„ä¸ªåœ°æ–¹ã€‚

## åŒä¸€åŒ–ç±»å‹

æœ€åï¼Œå†ç”¨ä¸€ä¸ªå®é™…é¡¹ç›®ä¸­çš„ç®€åŒ–ç‰‡æ®µï¼Œæ¥ç»“æŸæšä¸¾ç±»å‹çš„è¯­æ³•å­¦ä¹ ã€‚

ä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ª WEB æœåŠ¡ï¼Œéœ€è¦æ¥å—ç”¨æˆ·çš„é•¿è¿æ¥ï¼Œå‡è®¾è¿æ¥æœ‰ä¸¤ç§ï¼š`TcpStream` å’Œ `TlsStream`ï¼Œä½†æ˜¯æˆ‘ä»¬å¸Œæœ›å¯¹è¿™ä¸¤ä¸ªè¿æ¥çš„å¤„ç†æµç¨‹ç›¸åŒï¼Œä¹Ÿå°±æ˜¯ç”¨åŒä¸€ä¸ªå‡½æ•°æ¥å¤„ç†è¿™ä¸¤ä¸ªè¿æ¥ï¼Œä»£ç å¦‚ä¸‹ï¼š

```rust
fn new (stream: TcpStream) {
    let mut s = stream;
    if tls {
        s = negotiate_tls(stream)
    }

    // websocketæ˜¯ä¸€ä¸ª WebSocket<TcpStream> æˆ–è€…
    // WebSocket<native_tls::TlsStream<TcpStream>> 
    websocket = WebSocket::from_raw_socket(stream, ......)
}
```

æ­¤æ—¶ï¼Œæšä¸¾ç±»å‹å°±èƒ½å¸®ä¸Šå¤§å¿™ï¼š

```rust
enum Websocket {
    Tcp(Websocket<TcpStream>),
    Tls(Websocket<native_tls::TlsStream<TcpStream>>),
}
```

## Option æšä¸¾ç”¨äºå¤„ç†ç©ºå€¼

åœ¨å…¶å®ƒç¼–ç¨‹è¯­è¨€ä¸­ï¼Œå¾€å¾€éƒ½æœ‰ä¸€ä¸ª `null` å…³é”®å­—ã€‚å½“ä½ å¯¹è¿™äº› `null` è¿›è¡Œæ“ä½œæ—¶ï¼Œä¾‹å¦‚è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œå°±ä¼šç›´æ¥æŠ›å‡º**null å¼‚å¸¸**ï¼Œå¯¼è‡´ç¨‹åºçš„å´©æºƒï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–ç¨‹æ—¶éœ€è¦æ ¼å¤–çš„å°å¿ƒå»å¤„ç†è¿™äº› `null` ç©ºå€¼ã€‚

> Tony Hoareï¼Œ `null` çš„å‘æ˜è€…ï¼Œæ›¾ç»è¯´è¿‡ä¸€æ®µéå¸¸æœ‰åçš„è¯
>
> æˆ‘ç§°ä¹‹ä¸ºæˆ‘åäº¿ç¾å…ƒçš„é”™è¯¯ã€‚å½“æ—¶ï¼Œæˆ‘åœ¨ä½¿ç”¨ä¸€ä¸ªé¢å‘å¯¹è±¡è¯­è¨€è®¾è®¡ç¬¬ä¸€ä¸ªç»¼åˆæ€§çš„é¢å‘å¼•ç”¨çš„ç±»å‹ç³»ç»Ÿã€‚æˆ‘çš„ç›®æ ‡æ˜¯é€šè¿‡ç¼–è¯‘å™¨çš„è‡ªåŠ¨æ£€æŸ¥æ¥ä¿è¯æ‰€æœ‰å¼•ç”¨çš„ä½¿ç”¨éƒ½åº”è¯¥æ˜¯ç»å¯¹å®‰å…¨çš„ã€‚ä¸è¿‡åœ¨è®¾è®¡è¿‡ç¨‹ä¸­ï¼Œæˆ‘æœªèƒ½æŠµæŠ—ä½è¯±æƒ‘ï¼Œå¼•å…¥äº†ç©ºå¼•ç”¨çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒéå¸¸å®¹æ˜“å®ç°ã€‚å°±æ˜¯å› ä¸ºè¿™ä¸ªå†³ç­–ï¼Œå¼•å‘äº†æ— æ•°é”™è¯¯ã€æ¼æ´å’Œç³»ç»Ÿå´©æºƒï¼Œåœ¨ä¹‹åçš„å››åå¤šå¹´ä¸­é€ æˆäº†æ•°åäº¿ç¾å…ƒçš„è‹¦ç—›å’Œä¼¤å®³ã€‚

ç©ºå€¼è¡¨ç¤ºå½“å‰æ—¶åˆ»å˜é‡çš„å€¼æ˜¯ç¼ºå¤±çš„ï¼ŒRust å¸å–äº†ä¼—å¤šæ•™è®­ï¼Œå†³å®šæŠ›å¼ƒ `null`ï¼Œ**æ”¹ä¸ºä½¿ç”¨ `Option` æšä¸¾å˜é‡æ¥è¡¨è¿°è¿™ç§ç»“æœ**ã€‚

`Option` **æšä¸¾**åŒ…å«ä¸¤ä¸ªæˆå‘˜ï¼Œ**ä¸€ä¸ªæˆå‘˜è¡¨ç¤ºå«æœ‰å€¼ï¼š`Some(T)`, å¦ä¸€ä¸ªè¡¨ç¤ºæ²¡æœ‰å€¼ï¼š`None`**ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

```rust
enum Option<T> {
    Some(T),
    None,
}
```

å…¶ä¸­ `T` æ˜¯æ³›å‹å‚æ•°ï¼Œ`Some(T)`è¡¨ç¤ºè¯¥æšä¸¾æˆå‘˜çš„æ•°æ®ç±»å‹æ˜¯ `T`ï¼Œæ¢å¥è¯è¯´ï¼Œ`Some` å¯ä»¥åŒ…å«ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚

`Option<T>` æšä¸¾æ˜¯å¦‚æ­¤æœ‰ç”¨ä»¥è‡³äºå®ƒè¢«åŒ…å«åœ¨äº† [`prelude`](https://course.rs/appendix/prelude.html)ï¼ˆprelude å±äº Rust æ ‡å‡†åº“ï¼ŒRust ä¼šå°†æœ€å¸¸ç”¨çš„ç±»å‹ã€å‡½æ•°ç­‰æå‰å¼•å…¥å…¶ä¸­ï¼Œçœå¾—æˆ‘ä»¬å†æ‰‹åŠ¨å¼•å…¥ï¼‰ä¹‹ä¸­ï¼Œä¸éœ€è¦å°†å…¶æ˜¾å¼å¼•å…¥ä½œç”¨åŸŸã€‚å¦å¤–ï¼Œå®ƒçš„æˆå‘˜ `Some` å’Œ `None` ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œæ— éœ€ä½¿ç”¨ `Option::` å‰ç¼€å°±å¯ç›´æ¥ä½¿ç”¨ `Some` å’Œ `None`ã€‚ä½†ä¸èƒ½å› ä¸º `Some(T)` å’Œ `None` ä¸­æ²¡æœ‰ `Option::` çš„èº«å½±ï¼Œå°±å¦è®¤å®ƒä»¬æ˜¯ `Option` ä¸‹çš„å§é¾™å‡¤é›ã€‚

```rust
let some_number = Some(5);
let some_string = Some("a string");

let absent_number: Option<i32> = None;
```

å¦‚æœä½¿ç”¨ `None` è€Œä¸æ˜¯ `Some`ï¼Œéœ€è¦å‘Šè¯‰ Rust `Option<T>` æ˜¯ä»€ä¹ˆç±»å‹çš„ï¼Œ**ç¼–è¯‘å™¨åªé€šè¿‡ `None` å€¼æ— æ³•æ¨æ–­å‡º `Some` æˆå‘˜ä¿å­˜çš„å€¼çš„ç±»å‹**ã€‚

å½“æœ‰ä¸€ä¸ª `Some` å€¼æ—¶ï¼Œæˆ‘ä»¬å°±çŸ¥é“å­˜åœ¨ä¸€ä¸ªå€¼ï¼Œè€Œè¿™ä¸ªå€¼ä¿å­˜åœ¨ `Some` ä¸­ã€‚**å½“æœ‰ä¸ª `None` å€¼æ—¶ï¼Œåœ¨æŸç§æ„ä¹‰ä¸Šï¼Œå®ƒè·Ÿç©ºå€¼å…·æœ‰ç›¸åŒçš„æ„ä¹‰ï¼šå¹¶æ²¡æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å€¼**ã€‚é‚£ä¹ˆï¼Œ`Option<T>` ä¸ºä»€ä¹ˆå°±æ¯”ç©ºå€¼è¦å¥½å‘¢ï¼Ÿ

ç®€è€Œè¨€ä¹‹ï¼Œ**å› ä¸º `Option<T>` å’Œ `T`ï¼ˆè¿™é‡Œ `T` å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼‰æ˜¯ä¸åŒçš„ç±»å‹**ï¼Œä¾‹å¦‚ï¼Œè¿™æ®µä»£ç ä¸èƒ½ç¼–è¯‘ï¼Œå› ä¸ºå®ƒå°è¯•å°† `Option<i8>`(`Option<T>`) ä¸ `i8`(`T`) ç›¸åŠ ï¼š

```rust
let x: i8 = 5;
let y: Option<i8> = Some(5);

let sum = x + y;
```

å¦‚æœè¿è¡Œè¿™äº›ä»£ç ï¼Œå°†å¾—åˆ°ç±»ä¼¼è¿™æ ·çš„é”™è¯¯ä¿¡æ¯ï¼š

```text
error[E0277]: the trait bound `i8: std::ops::Add<std::option::Option<i8>>` is
not satisfied
 -->
  |
5 |     let sum = x + y;
  |                 ^ no implementation for `i8 + std::option::Option<i8>`
  |
```

é”™è¯¯ä¿¡æ¯æ„å‘³ç€ Rust ä¸çŸ¥é“è¯¥å¦‚ä½•å°† `Option<i8>` ä¸ `i8` ç›¸åŠ ï¼Œå› ä¸ºå®ƒä»¬çš„ç±»å‹ä¸åŒã€‚å½“åœ¨ Rust ä¸­æ‹¥æœ‰ä¸€ä¸ªåƒ `i8` è¿™æ ·ç±»å‹çš„å€¼æ—¶ï¼Œç¼–è¯‘å™¨ç¡®ä¿å®ƒæ€»æ˜¯æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ”¾å¿ƒä½¿ç”¨è€Œæ— éœ€åšç©ºå€¼æ£€æŸ¥ã€‚åªæœ‰å½“ä½¿ç”¨ `Option<i8>`ï¼ˆæˆ–è€…ä»»ä½•ç”¨åˆ°çš„ç±»å‹ï¼‰çš„æ—¶å€™æ‰éœ€è¦æ‹…å¿ƒå¯èƒ½æ²¡æœ‰å€¼ï¼Œè€Œç¼–è¯‘å™¨ä¼šç¡®ä¿æˆ‘ä»¬åœ¨ä½¿ç”¨å€¼ä¹‹å‰å¤„ç†äº†ä¸ºç©ºçš„æƒ…å†µã€‚

æ¢å¥è¯è¯´ï¼Œ**åœ¨å¯¹ `Option<T>` è¿›è¡Œ `T` çš„è¿ç®—ä¹‹å‰å¿…é¡»å°†å…¶è½¬æ¢ä¸º `T`ã€‚é€šå¸¸è¿™èƒ½å¸®åŠ©æˆ‘ä»¬æ•è·åˆ°ç©ºå€¼æœ€å¸¸è§çš„é—®é¢˜ä¹‹ä¸€ï¼šæœŸæœ›æŸå€¼ä¸ä¸ºç©ºä½†å®é™…ä¸Šä¸ºç©ºçš„æƒ…å†µ**ã€‚

ä¸å†æ‹…å¿ƒä¼šé”™è¯¯çš„ä½¿ç”¨ä¸€ä¸ªç©ºå€¼ï¼Œä¼šè®©ä½ å¯¹ä»£ç æ›´åŠ æœ‰ä¿¡å¿ƒã€‚ä¸ºäº†æ‹¥æœ‰ä¸€ä¸ªå¯èƒ½ä¸ºç©ºçš„å€¼ï¼Œä½ å¿…é¡»è¦æ˜¾å¼çš„å°†å…¶æ”¾å…¥å¯¹åº”ç±»å‹çš„ `Option<T>` ä¸­ã€‚æ¥ç€ï¼Œå½“ä½¿ç”¨è¿™ä¸ªå€¼æ—¶ï¼Œ**å¿…é¡»æ˜ç¡®çš„å¤„ç†å€¼ä¸ºç©ºçš„æƒ…å†µ**ã€‚**åªè¦ä¸€ä¸ªå€¼ä¸æ˜¯ `Option<T>` ç±»å‹ï¼Œä½ å°± å¯ä»¥ å®‰å…¨çš„è®¤å®šå®ƒçš„å€¼ä¸ä¸ºç©º**ã€‚

`Option<T>` æšä¸¾æ‹¥æœ‰å¤§é‡ç”¨äºå„ç§æƒ…å†µçš„æ–¹æ³•ï¼šå¦‚ä½•ä» `Some` æˆå‘˜ä¸­å–å‡º `T` çš„å€¼æ¥ä½¿ç”¨ï¼Œå¯ä»¥æŸ¥çœ‹[å®ƒçš„æ–‡æ¡£](https://doc.rust-lang.org/std/option/enum.Option.html)ã€‚

æ€»çš„æ¥è¯´ï¼Œä¸ºäº†ä½¿ç”¨ `Option<T>` å€¼ï¼Œéœ€è¦ç¼–å†™å¤„ç†æ¯ä¸ªæˆå‘˜çš„ä»£ç ã€‚ä½ æƒ³è¦ä¸€äº›ä»£ç åªå½“æ‹¥æœ‰ `Some(T)` å€¼æ—¶è¿è¡Œï¼Œå…è®¸è¿™äº›ä»£ç ä½¿ç”¨å…¶ä¸­çš„ `T`ã€‚ä¹Ÿå¸Œæœ›ä¸€äº›ä»£ç åœ¨å€¼ä¸º `None` æ—¶è¿è¡Œï¼Œè¿™äº›ä»£ç å¹¶æ²¡æœ‰ä¸€ä¸ªå¯ç”¨çš„ `T` å€¼ã€‚`match` è¡¨è¾¾å¼å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå¤„ç†æšä¸¾çš„æ§åˆ¶æµç»“æ„ï¼šå®ƒä¼šæ ¹æ®æšä¸¾çš„æˆå‘˜è¿è¡Œä¸åŒçš„ä»£ç ï¼Œè¿™äº›ä»£ç å¯ä»¥ä½¿ç”¨åŒ¹é…åˆ°çš„å€¼ä¸­çš„æ•°æ®ã€‚

è¿™é‡Œå…ˆç®€å•çœ‹ä¸€ä¸‹ `match` çš„å¤§è‡´æ¨¡æ ·ï¼š

```rust
fn plus_one(x: Option<i32>) -> Option<i32> {
    match x {
        None => None,
        Some(i) => Some(i + 1),
    }
}

let five = Some(5);
let six = plus_one(five);
let none = plus_one(None);
```

`plus_one` é€šè¿‡ `match` æ¥å¤„ç†ä¸åŒ `Option` çš„æƒ…å†µã€‚

## Practice



# æ•°ç»„

åœ¨ Rust ä¸­ï¼Œæœ€å¸¸ç”¨çš„æ•°ç»„æœ‰ä¸¤ç§ï¼Œç¬¬ä¸€ç§æ˜¯é€Ÿåº¦å¾ˆå¿«ä½†æ˜¯é•¿åº¦å›ºå®šçš„ `array`ï¼Œç¬¬äºŒç§æ˜¯å¯åŠ¨æ€å¢é•¿çš„ä½†æ˜¯æœ‰æ€§èƒ½æŸè€—çš„ `Vector`ï¼Œåœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬ç§° `array` ä¸ºæ•°ç»„ï¼Œ`Vector` ä¸ºåŠ¨æ€æ•°ç»„ã€‚

å¯¹äºæœ¬ç« èŠ‚ï¼Œæˆ‘ä»¬çš„é‡ç‚¹è¿˜æ˜¯æ”¾åœ¨æ•°ç»„ `array` ä¸Šã€‚æ•°ç»„çš„å…·ä½“å®šä¹‰å¾ˆç®€å•ï¼šå°†å¤šä¸ªç±»å‹ç›¸åŒçš„å…ƒç´ ä¾æ¬¡ç»„åˆåœ¨ä¸€èµ·ï¼Œå°±æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚ç»“åˆä¸Šé¢çš„å†…å®¹ï¼Œå¯ä»¥å¾—å‡ºæ•°ç»„çš„ä¸‰è¦ç´ ï¼š

- é•¿åº¦å›ºå®š
- å…ƒç´ å¿…é¡»æœ‰ç›¸åŒçš„ç±»å‹
- ä¾æ¬¡çº¿æ€§æ’åˆ—

è¿™é‡Œå†å•°å—¦ä¸€å¥ï¼Œ**æˆ‘ä»¬è¿™é‡Œè¯´çš„æ•°ç»„æ˜¯ Rust çš„åŸºæœ¬ç±»å‹ï¼Œæ˜¯å›ºå®šé•¿åº¦çš„ï¼Œè¿™ç‚¹ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸åŒï¼Œå…¶å®ƒç¼–ç¨‹è¯­è¨€çš„æ•°ç»„å¾€å¾€æ˜¯å¯å˜é•¿åº¦çš„ï¼Œä¸ Rust ä¸­çš„åŠ¨æ€æ•°ç»„ `Vector` ç±»ä¼¼**ã€‚

## åˆ›å»ºæ•°ç»„

åœ¨ Rust ä¸­ï¼Œæ•°ç»„æ˜¯è¿™æ ·å®šä¹‰çš„ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
}
```

å®ƒçš„å…ƒç´ ç±»å‹å¤§å°å›ºå®šï¼Œä¸”é•¿åº¦ä¹Ÿæ˜¯å›ºå®šï¼Œå› æ­¤**æ•°ç»„ `array` æ˜¯å­˜å‚¨åœ¨æ ˆä¸Š**ï¼Œæ€§èƒ½ä¹Ÿä¼šéå¸¸ä¼˜ç§€ã€‚ä¸æ­¤å¯¹åº”ï¼Œ**åŠ¨æ€æ•°ç»„ `Vector` æ˜¯å­˜å‚¨åœ¨å †ä¸Š**ï¼Œå› æ­¤é•¿åº¦å¯ä»¥åŠ¨æ€æ”¹å˜ã€‚å½“ä½ ä¸ç¡®å®šæ˜¯ä½¿ç”¨æ•°ç»„è¿˜æ˜¯åŠ¨æ€æ•°ç»„æ—¶ï¼Œé‚£å°±åº”è¯¥ä½¿ç”¨åè€…ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨éœ€è¦çŸ¥é“ä¸€å¹´ä¸­å„ä¸ªæœˆä»½åç§°çš„ç¨‹åºä¸­ï¼Œä½ å¾ˆå¯èƒ½å¸Œæœ›ä½¿ç”¨çš„æ˜¯æ•°ç»„è€Œä¸æ˜¯åŠ¨æ€æ•°ç»„ã€‚å› ä¸ºæœˆä»½æ˜¯å›ºå®šçš„ï¼Œå®ƒæ€»æ˜¯åªåŒ…å« 12 ä¸ªå…ƒç´ ï¼š

```rust
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

åœ¨ä¸€äº›æ—¶å€™ï¼Œè¿˜éœ€è¦ä¸º**æ•°ç»„å£°æ˜ç±»å‹**ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

è¿˜å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•åˆå§‹åŒ–ä¸€ä¸ª**æŸä¸ªå€¼é‡å¤å‡ºç° N æ¬¡çš„æ•°ç»„**ï¼š

```rust
let a = [3; 5];
```

`a` æ•°ç»„åŒ…å« `5` ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„åˆå§‹åŒ–å€¼ä¸º `3`ï¼Œèªæ˜çš„è¯»è€…å·²ç»å‘ç°ï¼Œè¿™ç§è¯­æ³•è·Ÿæ•°ç»„ç±»å‹çš„å£°æ˜è¯­æ³•å…¶å®æ˜¯ä¿æŒä¸€è‡´çš„ï¼š`[3; 5]` å’Œ `[ç±»å‹; é•¿åº¦]`ã€‚

## æ•°ç»„åˆ‡ç‰‡

å®ƒå…è®¸ä½ å¼•ç”¨é›†åˆä¸­çš„éƒ¨åˆ†è¿ç»­ç‰‡æ®µï¼Œè€Œä¸æ˜¯æ•´ä¸ªé›†åˆï¼Œæ•°ç»„åˆ‡ç‰‡å…è®¸æˆ‘ä»¬å¼•ç”¨æ•°ç»„çš„ä¸€éƒ¨åˆ†ï¼š

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
let slice: &[i32] = &a[1..3];
assert_eq!(slice, &[2, 3]);
```

ä¸Šé¢çš„æ•°ç»„åˆ‡ç‰‡ `slice` çš„ç±»å‹æ˜¯`&[i32]`ï¼Œä¸ä¹‹å¯¹æ¯”ï¼Œæ•°ç»„çš„ç±»å‹æ˜¯`[i32;5]`ï¼Œç®€å•æ€»ç»“ä¸‹åˆ‡ç‰‡çš„ç‰¹ç‚¹ï¼š

- åˆ‡ç‰‡çš„é•¿åº¦å¯ä»¥ä¸æ•°ç»„ä¸åŒï¼Œå¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯å–å†³äºä½ ä½¿ç”¨æ—¶æŒ‡å®šçš„èµ·å§‹å’Œç»“æŸä½ç½®
- åˆ›å»ºåˆ‡ç‰‡çš„ä»£ä»·éå¸¸å°ï¼Œå› ä¸ºåˆ‡ç‰‡åªæ˜¯é’ˆå¯¹åº•å±‚æ•°ç»„çš„ä¸€ä¸ªå¼•ç”¨
- åˆ‡ç‰‡ç±»å‹[T]æ‹¥æœ‰ä¸å›ºå®šçš„å¤§å°ï¼Œè€Œåˆ‡ç‰‡å¼•ç”¨ç±»å‹&[T]åˆ™å…·æœ‰å›ºå®šçš„å¤§å°ï¼Œå› ä¸º Rust å¾ˆå¤šæ—¶å€™éƒ½éœ€è¦å›ºå®šå¤§å°æ•°æ®ç±»å‹ï¼Œå› æ­¤&[T]æ›´æœ‰ç”¨,`&str`å­—ç¬¦ä¸²åˆ‡ç‰‡ä¹ŸåŒç†

## æ€»ç»“

æœ€åï¼Œè®©æˆ‘ä»¬ä»¥ä¸€ä¸ªç»¼åˆæ€§ä½¿ç”¨æ•°ç»„çš„ä¾‹å­ï¼Œæ¥ç»“æŸæœ¬ç« èŠ‚çš„å­¦ä¹ ï¼š

```rust
fn main() {
  // ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºoneçš„ç±»å‹
  let one             = [1, 2, 3];
  // æ˜¾å¼ç±»å‹æ ‡æ³¨
  let two: [u8; 3]    = [1, 2, 3];
  let blank1          = [0; 3];
  let blank2: [u8; 3] = [0; 3];

  // arraysæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ç±»å‹æ˜¯[u8; 3]
  let arrays: [[u8; 3]; 4]  = [one, two, blank1, blank2];

  // å€Ÿç”¨arraysçš„å…ƒç´ ç”¨ä½œå¾ªç¯ä¸­
  for a in &arrays {
    print!("{:?}: ", a);
    // å°†aå˜æˆä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯
    // ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨for n in a {}æ¥è¿›è¡Œå¾ªç¯
    for n in a.iter() {
      print!("\t{} + 10 = {}", n, n+10);
    }

    let mut sum = 0;
    // 0..a.len,æ˜¯ä¸€ä¸ª Rust çš„è¯­æ³•ç³–ï¼Œå…¶å®å°±ç­‰äºä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ æ˜¯ä»0,1,2ä¸€ç›´å¢åŠ åˆ°åˆ°a.len-1
    for i in 0..a.len() {
      sum += a[i];
    }
    println!("\t({:?} = {})", a, sum);
  }
}
```

åšä¸ªæ€»ç»“ï¼Œæ•°ç»„è™½ç„¶å¾ˆç®€å•ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯å­˜åœ¨å‡ ä¸ªè¦æ³¨æ„çš„ç‚¹ï¼š

- **æ•°ç»„ç±»å‹å®¹æ˜“è·Ÿæ•°ç»„åˆ‡ç‰‡æ··æ·†**ï¼Œ[T;n]æè¿°äº†ä¸€ä¸ªæ•°ç»„çš„ç±»å‹ï¼Œè€Œ[T]æè¿°äº†åˆ‡ç‰‡çš„ç±»å‹ï¼Œ å› ä¸ºåˆ‡ç‰‡æ˜¯è¿è¡ŒæœŸçš„æ•°æ®ç»“æ„ï¼Œå®ƒçš„é•¿åº¦æ— æ³•åœ¨ç¼–è¯‘æœŸå¾—çŸ¥ï¼Œå› æ­¤ä¸èƒ½ç”¨[T;n]çš„å½¢å¼å»æè¿°ã€‚
- **`[u8; 3]`å’Œ`[u8; 4]`æ˜¯ä¸åŒçš„ç±»å‹ï¼Œæ•°ç»„çš„é•¿åº¦ä¹Ÿæ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†**ã€‚
- **åœ¨å®é™…å¼€å‘ä¸­ï¼Œä½¿ç”¨æœ€å¤šçš„æ˜¯æ•°ç»„åˆ‡ç‰‡[T]**ï¼Œæˆ‘ä»¬å¾€å¾€é€šè¿‡å¼•ç”¨çš„æ–¹å¼å»ä½¿ç”¨`&[T]`ï¼Œå› ä¸ºåè€…æœ‰å›ºå®šçš„ç±»å‹å¤§å°ã€‚

## Practice
